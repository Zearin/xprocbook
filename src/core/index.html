<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Standard XProc Steps</title><style type="text/css">div.epigraph          { margin-left: 0.5in;
                        margin-right: 0.5in;
                      }

div.attribution       { margin-left: 50%;
                      }

div.admonition        { margin-left: 0.5in;
                        margin-right: 0.5in;
                        border: solid thin #aaaaaa;
                      }

div.admonition h3     { margin-top: 0px;
                        margin-bottom: 0px;
                        padding-top: 4px;
                        padding-left: 5px;
                        font-weight: medium;
                        background-color: #dddddd;
                      }

div.admonition p      { padding-left: 5px;
                      }

span.admon-graphic    { padding-right: 5px;
                        vertical-align: middle;
                      }

div.admon-title-text  { font-size: x-large;
                        font-weight: bold;
                      }

div.admon-text        { padding-top: 0px;
                        margin-top: 0px;
                      }

div.admon-text &gt; p:first-child { padding-top: 0px;
                                 margin-top: 0px;
                               }

div.section           { margin-left: 0.25in;
                      }
div.section-titlepage { margin-left: -0.25in;
                      }

span.linenumber       { padding-right: 10px;
                        border-right: 1px solid black;
                      }

span.linenumber-separator {
                        padding-right: 0px;
                      }

div.address           { white-space: pre }
div.literallayout     { white-space: pre }
span.linenumber       { white-space: pre;
                        font-family: monospace;
                      }
span.linenumber-separator { white-space: pre; }

div.footnote p { margin-top: 0px;
                 padding-top: 1px;
                 margin-bottom: 0px;
                 padding-bottom: 1px;
               }

div.title { font-weight: bold; }

div.float-right    { float: right; }
div.float-left     { float: left; }

div.figure-wrapper { padding: 0px;
                     border-color: #CACACA;
                     border-width: 1px;
                     border-style: solid;
                   }

div.figure         { padding-left: 3px;
                     padding-right: 3px;
                     padding-top: 5px;
                     padding-bottom: 5px;
                   }

div.informalfigure-wrapper { padding: 0px;
                     border-color: #CACACA;
                     border-width: 1px;
                     border-style: solid;
                   }

div.informalfigure { padding-left: 3px;
                     padding-right: 3px;
                     padding-top: 5px;
                     padding-bottom: 5px;
                   }

div.table-wrapper  { padding: 0px;
                     border-color: #CACACA;
                     border-width: 1px;
                     border-style: solid;
                   }

div.table          { padding-left: 3px;
                     padding-right: 3px;
                     padding-top: 5px;
                     padding-bottom: 5px;
                   }

/*
div.informaltable-wrapper { padding: 0px;
                     border-color: #CACACA;
                     border-width: 1px;
                     border-style: solid;
                   }
*/

div.informaltable  { padding-left: 3px;
                     padding-right: 3px;
                     padding-top: 5px;
                     padding-bottom: 5px;
                   }

div.equation-wrapper
div.title          { background-color: #CACACA;
                     padding: 3px;
                   }

div.example-wrapper
div.title          { background-color: #CACACA;
                     padding: 3px;
                   }
div.figure-wrapper
div.title          { background-color: #CACACA;
                     padding: 3px;
                   }

div.caption        { margin-left: 5%;
                     margin-right: 5%;
                     font-family: sans-serif;
                   }

div.longdesc-link  { position: absolute;
                     right: 10px;
                     font-size: small;
                   }

.revision-added    { background-color: #FFFF99; }

.revision-deleted  { text-decoration: line-through;
                     background-color: #FF9999;
                   }
.revision-changed  { background-color: #99FF99; }

.revision-inherited { border-left-style: solid;
                      border-left-width: 1px;
                      border-left-color: #303030;
                      padding-left: 10px;
                    }

div.synopfragment  { margin-bottom: 1em;
                   }

div.cmdsynopsis    { margin-bottom: 1em;
                   }

body.draft         { background-image: url("http://docbook.sf.net/release/images/draft.png");
                   }

em.strikethrough   { text-decoration: line-through;
                     font-style: normal;
                   }

em.underline       { text-decoration: underline;
                     font-style: normal;
                   }

em                 { font-style: italic; }

em em              { font-style: normal; }

em em em           { font-style: italic; }

em em em em        { font-style: normal; }

em em em em em     { font-style: italic; }

div.remark         { padding: 10px;
                     border: solid #afafaf 1px;
                     margin-left: 35px;
                     margin-right: 70px;
                     margin-bottom: 1ex;
                   }


div.sidebar        { border: solid #afafaf 1px;
                     margin-left: 35px;
                     margin-right: 70px;
                     margin-bottom: 1ex;
                   }

div.sidebar
div.title          { background-color: #CACACA;
                     padding: 3px;
                   }

div.sidebar-content { padding: 10px;
                    }

div.annotation     { border: solid #afafaf 1px;
                     margin-left: 35px;
                     margin-right: 70px;
                     margin-top: 1ex;
                     margin-bottom: 1ex;
                   }

div.annotation
div.title          { background-color: #CACACA;
                     padding: 3px;
                   }

div.annotation-content { padding: 10px;
                    }
</style><style type="text/css">p.element-syntax                    { padding: 4px; }
p.element-syntax-declare-step       { border: solid thin; background-color: #ffeeff }
p.element-syntax-error-vocabulary   { border: solid thin; background-color: #ffffee }
p.element-syntax-language-construct { border: solid thin; background-color: #ffeeff }
p.element-syntax-language-example   { border: solid thin; background-color: #ffeeff }
p.element-syntax-other-step         { border: solid thin; background-color: #ffeeff }
p.element-syntax-step-vocabulary    { border: solid thin; background-color: #ffffee }

thead tr th {
  background-color: #333333;
  color: white;
}

h1,h2,h3,h4,h5,h6,
.toc p {
  font-family: sans-serif;
}

h2 .refname tt {
  font-family: sans-serif;
}

.programlisting, .screen {
  padding-top: 0px;
  padding-bottom: 0px;
  border: solid thin #ccddcc;
  background-color: #eeffee;
}

.programlisting pre, .screen pre {
  padding-top: 0px;
  padding-bottom: 0px;
  margin-top: 0px;
  margin-bottom: 0px;
}

span.linenumber {
  background-color: #ccddcc;
}

.admonition {
  padding: 10px;
  border: solid thin #ccdddcc;
}

.admonition h3 {
  font-size: normal;
}

span.diff, div.diff {
  background-color: #ffffaa;
}

span.add, div.add {
  background-color: #aaffaa;
}

span.orig, div.orig {
  background-color: #ffffaa;
}

span.del, div.del {
  background-color: #ffaaaa;
  text-decoration: line-through;
}

div.line {
  font-family: monospace;
  white-space: pre;
}

table.pipelineexample {
  margin-top: "0.5em;"
}

.exlink {
  text-align: right;
  padding-right: 45px;
  padding-top: 2px;
  padding-bottom: 4px;
}

.exlink a,
.exlink a:visited {
  color: black;
  text-decoration: none;
  font-family: sans-serif;
  font-size: small;
}

/* Pretty printing */

.atteq {
}

.attq {
}

.colon {
}

.mso {
}

.msc {
}

.nsdecl,
.nsdecl .tag-attribute,
.nsdecl .tag-attvalue {
  color: #AAAAAA;
}

.pcdata {
  color: #44AA44;
}

pre .tag-attribute {
}

pre .tag-attvalue {
}

pre .tag-element {
}

pre .tag-localname {
}

pre .tag-prefix {
}

/* /Pretty printing */</style></head><body><div class="reference" id="fileutils"><div class="reference-titlepage"><h1>Standard XProc Steps</h1></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="refentrytitle"><a href="#p.add-attribute"><tt class="step">p:add-attribute</tt></a></span><span class="refpurpose"> - Adds a single attribute to the selected element (or elements)</span></dt><dt><span class="refentrytitle"><a href="#p.add-xml-base"><tt class="step">p:add-xml-base</tt></a></span><span class="refpurpose"> - Adds explicit xml:base attributes</span></dt><dt><span class="refentrytitle"><a href="#p.compare"><tt class="step">p:compare</tt></a></span><span class="refpurpose"> - Compares two documents for equality</span></dt><dt><span class="refentrytitle"><a href="#p.count"><tt class="step">p:count</tt></a></span><span class="refpurpose"> - Counts the number of documents that appear in a sequence</span></dt><dt><span class="refentrytitle"><a href="#p.delete"><tt class="step">p:delete</tt></a></span><span class="refpurpose"> - Deletes matching nodes</span></dt><dt><span class="refentrytitle"><a href="#p.directory-list"><tt class="step">p:directory-list</tt></a></span><span class="refpurpose"> - Lists the files, directories, and other contents of a directory on the filesystem</span></dt><dt><span class="refentrytitle"><a href="#p.error"><tt class="step">p:error</tt></a></span><span class="refpurpose"> - Causes an error</span></dt><dt><span class="refentrytitle"><a href="#p.escape-markup"><tt class="step">p:escape-markup</tt></a></span><span class="refpurpose"> - Escapes XML markup</span></dt><dt><span class="refentrytitle"><a href="#p.exec"><tt class="step">p:exec</tt></a></span><span class="refpurpose"> - Runs an external command</span></dt><dt><span class="refentrytitle"><a href="#p.filter"><tt class="step">p:filter</tt></a></span><span class="refpurpose"> - Filters documents with a dynamically constructed select expression</span></dt><dt><span class="refentrytitle"><a href="#p.hash"><tt class="step">p:hash</tt></a></span><span class="refpurpose"> - Computes a cryptographic hash and inserts it into a document</span></dt><dt><span class="refentrytitle"><a href="#p.http-request"><tt class="step">p:http-request</tt></a></span><span class="refpurpose"> - Interact with other systems over HTTP</span></dt><dt><span class="refentrytitle"><a href="#p.identity"><tt class="step">p:identity</tt></a></span><span class="refpurpose"> - Passes its input through unchanged</span></dt><dt><span class="refentrytitle"><a href="#p.insert"><tt class="step">p:insert</tt></a></span><span class="refpurpose"> - Inserts content into a document</span></dt><dt><span class="refentrytitle"><a href="#p.label-elements"><tt class="step">p:label-elements</tt></a></span><span class="refpurpose"> - Adds an attribute (often xml:id) to matching elements</span></dt><dt><span class="refentrytitle"><a href="#p.load"><tt class="step">p:load</tt></a></span><span class="refpurpose"> - Loads a document from a URI</span></dt><dt><span class="refentrytitle"><a href="#p.make-absolute-uris"><tt class="step">p:make-absolute-uris</tt></a></span><span class="refpurpose"> - Resolves relative URIs to absolute URIs in the source document</span></dt><dt><span class="refentrytitle"><a href="#p.namespace-rename"><tt class="step">p:namespace-rename</tt></a></span><span class="refpurpose"> - Changes the URI associated with a namespace binding</span></dt><dt><span class="refentrytitle"><a href="#p.pack"><tt class="step">p:pack</tt></a></span><span class="refpurpose"> - Merges two document sequences</span></dt><dt><span class="refentrytitle"><a href="#p.parameters"><tt class="step">p:parameters</tt></a></span><span class="refpurpose"> - Converts step parameters into XML</span></dt><dt><span class="refentrytitle"><a href="#p.rename"><tt class="step">p:rename</tt></a></span><span class="refpurpose"> - Renames elements, attributes, or processing instructions</span></dt><dt><span class="refentrytitle"><a href="#p.replace"><tt class="step">p:replace</tt></a></span><span class="refpurpose"> - Replaces matching content</span></dt><dt><span class="refentrytitle"><a href="#p.set-attributes"><tt class="step">p:set-attributes</tt></a></span><span class="refpurpose"> - Sets a number of attributes at once</span></dt><dt><span class="refentrytitle"><a href="#p.sink"><tt class="step">p:sink</tt></a></span><span class="refpurpose"> - Discards its input</span></dt><dt><span class="refentrytitle"><a href="#p.split-sequence"><tt class="step">p:split-sequence</tt></a></span><span class="refpurpose"> - Divides a sequence of documents into two sequences</span></dt><dt><span class="refentrytitle"><a href="#p.store"><tt class="step">p:store</tt></a></span><span class="refpurpose"> - Stores a document (usually on the filesystem)</span></dt><dt><span class="refentrytitle"><a href="#p.string-replace"><tt class="step">p:string-replace</tt></a></span><span class="refpurpose"> - Replaces matched nodes with the result of evaluating an XPath expression</span></dt><dt><span class="refentrytitle"><a href="#p.unescape-markup"><tt class="step">p:unescape-markup</tt></a></span><span class="refpurpose"> - Converts “escaped XML” back into real XML</span></dt><dt><span class="refentrytitle"><a href="#p.unwrap"><tt class="step">p:unwrap</tt></a></span><span class="refpurpose"> - Removes an element, but not its content</span></dt><dt><span class="refentrytitle"><a href="#p.uuid"><tt class="step">p:uuid</tt></a></span><span class="refpurpose"> - Generates a UUID and inserts it into a document</span></dt><dt><span class="refentrytitle"><a href="#p.validate-with-relax-ng"><tt class="step">p:validate-with-relax-ng</tt></a></span><span class="refpurpose"> - Validates a document using a RELAX NG grammar</span></dt><dt><span class="refentrytitle"><a href="#p.validate-with-schematron"><tt class="step">p:validate-with-schematron</tt></a></span><span class="refpurpose"> - Validates a document using a Schematron schema</span></dt><dt><span class="refentrytitle"><a href="#p.validate-with-xml-schema"><tt class="step">p:validate-with-xml-schema</tt></a></span><span class="refpurpose"> - Validates a document using W3C XML Schema</span></dt><dt><span class="refentrytitle"><a href="#p.wrap-sequence"><tt class="step">p:wrap-sequence</tt></a></span><span class="refpurpose"> - Places an element wrapper around a sequence of documents</span></dt><dt><span class="refentrytitle"><a href="#p.wrap"><tt class="step">p:wrap</tt></a></span><span class="refpurpose"> - Adds a wrapper around matching nodes</span></dt><dt><span class="refentrytitle"><a href="#p.www-form-urldecode"><tt class="step">p:www-form-urldecode</tt></a></span><span class="refpurpose"> - Decodes URL encoded form data</span></dt><dt><span class="refentrytitle"><a href="#p.www-form-urlencode"><tt class="step">p:www-form-urlencode</tt></a></span><span class="refpurpose"> - Encodes parameters into URL encoded form data</span></dt><dt><span class="refentrytitle"><a href="#p.xinclude"><tt class="step">p:xinclude</tt></a></span><span class="refpurpose"> - Performs XInclude processing</span></dt><dt><span class="refentrytitle"><a href="#p.xquery"><tt class="step">p:xquery</tt></a></span><span class="refpurpose"> - Performs XQuery processing</span></dt><dt><span class="refentrytitle"><a href="#p.xsl-formatter"><tt class="step">p:xsl-formatter</tt></a></span><span class="refpurpose"> - Performs XSL FO processing</span></dt><dt><span class="refentrytitle"><a href="#p.xslt"><tt class="step">p:xslt</tt></a></span><span class="refpurpose"> - Performs XSLT processing</span></dt></dl></div><div class="refentry" id="p.add-attribute"><div class="refnamediv"><h2><span class="refname"><tt class="step">p:add-attribute</tt></span></h2><p><span class="refname"><tt class="step">p:add-attribute</tt></span> — Adds a single attribute to the selected element (or elements).</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:add-attribute</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">attribute-name</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>             </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">attribute-prefix</code><code>"</code><code>/&gt;</code><code>                           </code><code class="comment">&lt;!-- </code><span class="opt-type">NCName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">attribute-namespace</code><code>"</code><code>/&gt;</code><code>                        </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">attribute-value</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>            </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:add-attribute</tt> step adds a single attribute to
any matching element in the <tt class="port">source</tt> document. The name of
the attribute is computed from the <tt class="option">attribute-name</tt>,
<tt class="option">attribute-prefix</tt>, and <tt class="option">attribute-namespace</tt>
options. The <tt class="option">attribute-value</tt> option specifies its value.
</p>

<p>If the <tt class="option">attribute-name</tt> value contains a colon, then
its value is interpreted as a QName and there must be an in-scope namespace
declaration for that prefix in the pipeline document. It is an error in this
case to specify either an <tt class="option">attribute-prefix</tt> or
<tt class="option">attribute-namespace</tt>.</p>

<p>If you specify an <tt class="option">attribute-namespace</tt>, you must
also specify an <tt class="option">attribute-prefix</tt>. In XML, attributes cannot
be in a namespace unless they have a prefix.</p>

<p>If you attempt to add an attribute to an element that already has
an attribute with that name, the attribute will remain on that element but
will have the value specified in <tt class="option">attribute-value</tt>.
</p>

<p>Recall that in XML, namespace declarations are not attributes. You
cannot add “attributes” named <tt class="literal">xmlns</tt> or
<tt class="literal">xmlns:<em class="replaceable"><tt class="replaceable">somename</tt></em></tt> with
<tt class="step">p:add-attribute</tt>. However, if you add an attribute that appears
in a namespace, the processor will add a namespace declaration for that
namespace automatically, if one is needed.</p>

<p>If an attribute named <tt class="tag-attribute">xml:base</tt> is
added or changed, the base URI of the element will be amended
accordingly.</p>

<div class="refsection"><div class="refsection-titlepage"><h4>Related Steps</h4></div>

<p>The <tt class="step">p:add-attribute</tt> step uses the same attribute
value everywhere that it inserts an attribute. If you need to vary the
value depending on where it's inserted, <tt class="step">p:label-elements</tt>
may provide the flexibility that you need.</p>

<p>If you want to set multiple attributes on the same element (or
elements), <tt class="step">p:set-attributes</tt> can be used to set them all
at once.</p>
</div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>


<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0023"/><code>err:C0023</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the match pattern matches anything other than an element.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.D0034"/><code>err:D0034</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the <tt class="option">attribute-name</tt> contains a colon and you attempt
to specify either an <tt class="option">attribute-prefix</tt> or
<tt class="option">attribute-namespace</tt>.</td></tr><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0059"/><code>err:C0059</code></td><td style="">Occurs
if any attempt is made to construct a namespace declaration using the
<tt class="step">p:add-attribute</tt> step.</td></tr></tbody></table></div></div>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This pipeline adds a <tt class="tag-attribute">class</tt> attribute to any
    HTML <tt class="tag-element">div</tt>
    that contains a <tt class="tag-element">pre</tt>.
    </p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">add-attribute</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">h:div[h:pre]</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">attribute-name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">class</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">attribute-value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">example</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/add-attribute-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some more example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">example</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">example</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some more example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>The <tt class="tag-element">p:add-attribute</tt> step replaces attributes if they
already exist:</p><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Other Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">original value</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Other Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">example</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.add-xml-base"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:add-xml-base</tt></span></h2><p><span class="refname"><tt class="step">p:add-xml-base</tt></span> — Adds explicit <tt class="tag-attribute">xml:base</tt> attributes.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:add-xml-base</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">all</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>                       </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">relative</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>                   </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:add-xml-base</tt> step exposes the base URIs in the
document via
explicit <tt class="tag-attribute">xml:base</tt> attributes. The input document from the
<tt class="port">source</tt> port is copied to the <tt class="port">result</tt> port
with <tt class="tag-attribute">xml:base</tt> attributes added to, or corrected on, each
element as specified by the options on this step.</p>

<p>XML provides documents, elements, and processing instructions with
an intrinsic “base URI” property. As documents flow through an XProc
pipeline this property is generally preserved. However, there are
operations that cannot preserve the intrinsic base URI; examples include
storing the document to disk or sending it to a remote web service
via <tt class="step">p:http-request</tt>.</p>

<p>The <span class="formatting-error">???</span> specification provides for
an explicit syntax to represent the base URI: the <tt class="tag-attribute">xml:base</tt>
attribute.</p>

<p>This step makes any base URIs in the document explicit using
<tt class="tag-attribute">xml:base</tt>. Specifically:</p>

<div class="itemizedlist"><ul><li><p>An <tt class="tag-attribute">xml:base</tt> attribute is added to the document element.
</p></li><li><p>For other elements, if either the <tt class="option">all</tt> option
is true or the base URI of the element is different than its parent,
an <tt class="tag-attribute">xml:base</tt> attribute is added to the element.
</p></li></ul></div>

<p>If the <tt class="option">relative</tt> option is <tt class="literal">true</tt>,
then the value of the <tt class="tag-attribute">xml:base</tt> attribute is an appropriate
relative URI, otherwise it's an absolute URI.</p>

<div class="note admonition"><h3>Note</h3><p>If the <tt class="option">all</tt> option is <tt class="literal">false</tt>, then
<tt class="step">p:add-xml-base</tt> attributes will actually <em>remove</em>
redundant <tt class="tag-attribute">xml:base</tt> attributes. In other words, you can think of
the process as removing all <tt class="tag-attribute">xml:base</tt> attributes and then only
adding the ones that are necessary per the options specified to the
step.</p></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>


<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0058"/><code>err:C0058</code></td><td style="">Occurs
if the <tt class="option">all</tt> and <tt class="option">relative</tt> options are
<em>both</em> <tt class="literal">true</tt>.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This examples in this section rely on the fact that the
    input document is constructed using an XML feature called external
    parsed entities:</p><div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;!DOCTYPE book [
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!ENTITY ch01 SYSTEM "chaps/ch01.xml"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!ENTITY ch02 SYSTEM "chaps/ch02.xml"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!ENTITY appa SYSTEM "apps/appa.xml"&gt;
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>]&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;book&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;title&gt;Some Title&lt;/title&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&amp;ch01;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&amp;ch02;
<span class="linenumber"> 10</span><span class="linenumber-separator"> </span>&amp;appa;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/book&gt;
</pre></div><p>When the parser expands the entities, the base URI of the
      parts becomes part of the data model, but it's not reflected in the
      serialized form shown below. This is <em>precisely</em>
      the problem that <tt class="step">p:add-xml-base</tt> is designed to address.
      </p><p>With that caveat, we can see how this pipeline adds
    <tt class="tag-attribute">xml:base</tt> attributes where necessary in the document.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">add-xml-base</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/add-xml-base-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">book</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">First chapter</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Second chapter</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">appendix</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Appendix</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">appendix</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">book</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">book</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/main.xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">chaps/ch01.xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">First chapter</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">chaps/ch02.xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Second chapter</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">appendix</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">apps/appa.xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Appendix</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">appendix</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">book</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>This pipeline performs the same function, but inserts absolute
    URIs throughout.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">add-xml-base</tt><span class="pcdata"> </span><tt class="tag-attribute">relative</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">false</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/add-xml-base-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">book</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">First chapter</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Second chapter</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">appendix</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Appendix</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">appendix</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">book</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">book</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/main.xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/chaps/ch01.xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">First chapter</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/chaps/ch02.xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Second chapter</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">appendix</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/apps/appa.xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Appendix</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">appendix</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">book</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>The <tt class="option">all</tt> option can be used to force
<tt class="tag-attribute">xml:base</tt> attributes throughout.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">add-xml-base</tt><span class="pcdata"> </span><tt class="tag-attribute">relative</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">false</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">all</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/add-xml-base-3.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">book</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">First chapter</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Second chapter</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">appendix</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Appendix</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">appendix</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">book</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">book</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/main.xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/main.xml</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/chaps/ch01.xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/chaps/ch01.xml</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">First chapter</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/chaps/ch01.xml</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/chaps/ch02.xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/chaps/ch02.xml</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Second chapter</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/chaps/ch02.xml</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">appendix</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/apps/appa.xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/apps/appa.xml</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Appendix</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/docs/apps/appa.xml</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">appendix</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">book</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.compare"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:compare</tt></span></h2><p><span class="refname"><tt class="step">p:compare</tt></span> — Compares two documents for equality.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:compare</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">alternate</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">false</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">fail-if-not-equal</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>         </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="code">p:compare</tt> step compares two documents for
equality. Two documents are considered equal if they are equal
according to the semantics of the <tt class="function">deep-equal</tt>
function (see <span class="formatting-error">???</span>).</p>

<p>The step returns a <tt class="tag-element">c:result</tt> element that contains either
<tt class="literal">true</tt> or <tt class="literal">false</tt> indicating whether
or not the documents were equal.</p>

<p>If the <tt class="option">fail-if-not-equal</tt> option is
<tt class="literal">true</tt>, the step fails if the documents are not
equal.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>


<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0019"/><code>err:C0019</code></td><td style="">Occurs
if the documents are not equal, and the value
of the <tt class="option">fail-if-not-equal</tt> option is
<tt class="literal">true</tt>.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This pipeline compares its single input document against
a fixed alternative. It returns true if they're the same.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">declare-step</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">output</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">compare</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">output</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">compare</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">compare</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">alternate</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">First para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Second para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Third para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">compare</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">declare-step</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/compare-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">First para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Second para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Third para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span><span class="pcdata">true</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>It returns false if they're different.</p><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Not the same.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span><span class="pcdata">false</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>If <tt class="option">fail-if-not-equal</tt> is
“<tt class="literal">true</tt>”, then the step fails when the documents
are different.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">try</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">group</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">compare</tt><span class="pcdata"> </span><tt class="tag-attribute">fail-if-not-equal</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">alternate</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">First para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Second para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Third para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">compare</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-localname">PASS</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">group</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 25</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">catch</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-localname">FAIL</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 30</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">catch</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">try</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 35</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/compare-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Not the same.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">FAIL</tt><span class="msc">/&gt;</span></span></div></div></td></tr></table><p>And succeeds if they're the same.</p><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">First para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Second para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Third para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">PASS</tt><span class="msc">/&gt;</span></span></div></div></td></tr></table><div class="note admonition"><h3>Note</h3><p>The <tt class="step">p:compare</tt> step is
      <em>very</em> sensitive to changes in the document.
      Changes in the leading and trailing whitespace around the
      document element, for example, is enough to make the documents
      different. As shown, the “pretty printed” examples in this book would
      actually be different because there is extra whitespace inside the
      <tt class="tag-element">p:inline</tt> elements.</p><p>If you look at the source for the pipelines, you'll see that
      we very carefully made the whitespace the same.</p></div>

</div></div><div class="refentry" id="p.count"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:count</tt></span></h2><p><span class="refname"><tt class="step">p:count</tt></span> — Counts the number of documents that appear in a sequence.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:count</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">limit</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">0</code><code>"</code><code>/&gt;</code><code>                           </code><code class="comment">&lt;!-- </code><span class="opt-type">integer</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:count</tt> step counts the number of documents on
the <tt class="port">source</tt> port. It returns a single <tt class="tag-element">c:result</tt>
element containing the number.</p>

<p>If the <tt class="tag-attribute">limit</tt> option is specified
and is greater than zero, the <tt class="tag-element">p:count</tt> step will count at most
that many documents. This provides a convenient mechanism to discover,
for example, if a sequence consists of more than 1 document, without
requiring every single document to be buffered before processing can
continue.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This pipeline counts the number of paragraphs in the document.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">count</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">//para</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">count</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/count-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">First para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Second para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Third para.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span><span class="pcdata">3</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.delete"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:delete</tt></span></h2><p><span class="refname"><tt class="step">p:delete</tt></span> — Deletes matching nodes.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:delete</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:delete</tt> step deletes elements, attributes,
processing instructions or text nodes that match the specified
pattern. It cannot remove namespace nodes.</p>

<p>If an element is selected by the <tt class="option">match</tt> option,
the entire subtree rooted at that element is deleted.</p>

<p>If an attribute named <tt class="tag-attribute">xml:base</tt> is deleted, that
<em>does not</em> change the base URI of the element on
which it occurred.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>


<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0062"/><code>err:C0062</code></td><td style="">
Occurs if the <tt class="option">match</tt> option matches a namespace
node.</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This pipeline deletes elements with a <tt class="tag-attribute">class</tt> attribute
that contains the string “<tt class="literal">del</tt>”.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">delete</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">*[contains(@class,'del')]</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/delete-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">add</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">This is new text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">chg</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del strikeout</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some more example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">add</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">This is new text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">chg</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del strikeout</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some more example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Multiple deletes can be accomplished by pipelining several
<tt class="step">p:delete</tt> steps. This pipeline removes all the change
markup.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">delete</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">*[contains(@class,'del')]</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">delete</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">*[contains(@class,'add')]/@class</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">delete</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">*[contains(@class,'chg')]/@class</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/delete-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">add</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">This is new text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">chg</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del strikeout</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some more example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">This is new text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del strikeout</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some more example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.directory-list"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:directory-list</tt></span></h2><p><span class="refname"><tt class="step">p:directory-list</tt></span> — Lists the files, directories, and other contents of a directory on the filesystem.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:directory-list</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">path</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                       </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">include-filter</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">RegularExpression</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">exclude-filter</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">RegularExpression</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="code">p:directory-list</tt> step lists the contents of the
specified directory on the filesystem.</p>

<p>The value of the <tt class="option">path</tt> option is interpreted as
an IRI reference. If it is relative, it is made absolute against the
base URI of the element on which it is specified.</p>

<p>The values of the <tt class="option">include-filter</tt> and
<tt class="option">exclude-filter</tt> options are regular expression as
specified in <span class="formatting-error">???</span>, section 7.61
“<tt class="literal">Regular Expression Syntax</tt>”.</p>

<p>If the <tt class="option">include-filter</tt> pattern matches the name
of a filesystem object, that object is included in the output. If the
<tt class="option">exclude-filter</tt> pattern matches the name, that object
is excluded from the output. If both options are provided, the include
filter is processed first, then the exclude filter.</p>

<p>Processors must support directory paths whose scheme is <tt class="uri">file:</tt>; they may also support other schemes, but
the semantics of those schemes is
<em class="glossterm">implementation-defined</em>.</p>

<p>The “<tt class="tag-element">c:directory</tt>” document that the
<tt class="step">p:directory-list</tt> step produces lists the included
filesystem objects. The base URI of the document is
the directory path read; it has a <tt class="tag-attribute">name</tt>
attribute that is the last segment of the directory path.
</p>

<p>The children of the <tt class="tag-element">c:directory</tt> element represent
each of the included filesystem objects:</p>

<div class="itemizedlist"><ul><li><p>A <tt class="tag-element">c:directory</tt> is produced for each subdirectory.
</p></li><li><p>A <tt class="tag-element">c:file</tt> is produced for each file.
</p></li><li><p>If the filesystem supports “special” objects (devices, links, etc.),
those may be represented with <tt class="tag-element">c:other</tt> elements. Exactly what
constitutes “special” is <em class="glossterm">implementation-defined</em>
and may vary by platform.</p></li></ul></div>

<p>The <tt class="step">c:directory-list</tt> step does not process subdirectories
recursively. For recursive processing, see
<span class="formatting-error">???</span>.</p>

<p>Each of the elements <tt class="tag-element">c:file</tt>, <tt class="tag-element">c:directory</tt>,
and <tt class="tag-element">c:other</tt> has a <tt class="code">name</tt> whose
value is a relative IRI reference, giving the (local) file or
directory name.
Implementations may include additional attributes.
</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>


<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0012"/><code>err:C0012</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the step cannot read the specified directory due to access restrictions
or if the environment doesn't support the notion of a hierarchical directory
structure.
</td></tr><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0017"/><code>err:C0017</code></td><td style="">Occurs
if the absolute <tt class="option">path</tt> does not specify a directory.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>What's in my “XProc book” directory? Let's see! (This
    example pipeline is in a directory a couple of levels below the
    main book directory, hence the “<tt class="filename">../..</tt>”.)</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">directory-list</tt><span class="pcdata"> </span><tt class="tag-attribute">path</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">../..</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/directory-list-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">             </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">src</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">             </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">.svn</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">bibl.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">bibl.xml~</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">book.html</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">book.html~</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">book.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">book.xml~</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch01.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch02.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch03.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch04.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch04.xml~</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch05.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch05.xml~</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch06.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch06.xml~</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch07.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch07.xml~</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch08.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch08.xml~</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">compound</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 25</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">core</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">examples</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">fileutils</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">glossary.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">glossary.xml~</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 30</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Makefile</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Makefile~</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">osutils</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schemas.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schemas.xml~</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 35</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">template.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">utils</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">x</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">xc01.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">xc01.xml~</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 40</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">xc02.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">xpl</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">xproc.xpr</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>If you only want the XML files, use a filter:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">directory-list</tt><span class="pcdata"> </span><tt class="tag-attribute">path</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">../..</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">include-filter</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">^.*\.xml$</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/directory-list-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">             </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">src</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">             </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">bibl.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">book.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch01.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch02.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch03.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch04.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch05.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch06.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch07.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ch08.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">glossary.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schemas.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">template.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">xc01.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">file</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">xc02.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">directory</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div><div class="refsection"><div class="refsection-titlepage"><h3>A Recursive Directory Listing</h3></div>


<p>The standard <tt class="step">p:directory-list</tt> step does not build
an entire tree, it only returns the contents of a single directory.
But it's easy to write your own recursive processor directly in
XProc:</p>

<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
<span class="linenumber">   </span><span class="linenumber-separator"> </span>		xmlns:c="http://www.w3.org/ns/xproc-step"
<span class="linenumber">   </span><span class="linenumber-separator"> </span>		xmlns:cx="http://xmlcalabash.com/ns/extensions"
<span class="linenumber">   </span><span class="linenumber-separator"> </span>                type="cx:recursive-directory-list"
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>                version="1.0"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;p:output port="result"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;p:option name="path" required="true"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;p:option name="include-filter"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;p:option name="exclude-filter"/&gt;
<span class="linenumber"> 10</span><span class="linenumber-separator"> </span>  &lt;p:option name="depth" select="-1"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;p:choose&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:when test="p:value-available('include-filter')
<span class="linenumber">   </span><span class="linenumber-separator"> </span>                  and p:value-available('exclude-filter')"&gt;
<span class="linenumber"> 15</span><span class="linenumber-separator"> </span>      &lt;p:directory-list&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>        &lt;p:with-option name="path" select="$path"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>        &lt;p:with-option name="include-filter" select="$include-filter"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>        &lt;p:with-option name="exclude-filter" select="$exclude-filter"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;/p:directory-list&gt;
<span class="linenumber"> 20</span><span class="linenumber-separator"> </span>    &lt;/p:when&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:when test="p:value-available('include-filter')"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;p:directory-list&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>        &lt;p:with-option name="path" select="$path"/&gt;
<span class="linenumber"> 25</span><span class="linenumber-separator"> </span>        &lt;p:with-option name="include-filter" select="$include-filter"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;/p:directory-list&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;/p:when&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:when test="p:value-available('exclude-filter')"&gt;
<span class="linenumber"> 30</span><span class="linenumber-separator"> </span>      &lt;p:directory-list&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>        &lt;p:with-option name="path" select="$path"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>        &lt;p:with-option name="exclude-filter" select="$exclude-filter"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;/p:directory-list&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;/p:when&gt;
<span class="linenumber"> 35</span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:otherwise&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;p:directory-list&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>        &lt;p:with-option name="path" select="$path"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;/p:directory-list&gt;
<span class="linenumber"> 40</span><span class="linenumber-separator"> </span>    &lt;/p:otherwise&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;/p:choose&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;p:viewport match="/c:directory/c:directory"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:variable name="name" select="/*/@name"/&gt;
<span class="linenumber"> 45</span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:choose&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;p:when test="$depth != 0"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>        &lt;p:choose&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>          &lt;p:when test="p:value-available('include-filter')
<span class="linenumber"> 50</span><span class="linenumber-separator"> </span>                        and p:value-available('exclude-filter')"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>            &lt;cx:recursive-directory-list&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>              &lt;p:with-option name="path" select="concat($path,'/',$name)"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>              &lt;p:with-option name="include-filter" select="$include-filter"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>              &lt;p:with-option name="exclude-filter" select="$exclude-filter"/&gt;
<span class="linenumber"> 55</span><span class="linenumber-separator"> </span>              &lt;p:with-option name="depth" select="$depth - 1"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>            &lt;/cx:recursive-directory-list&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>          &lt;/p:when&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>          &lt;p:when test="p:value-available('include-filter')"&gt;
<span class="linenumber"> 60</span><span class="linenumber-separator"> </span>            &lt;cx:recursive-directory-list&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>              &lt;p:with-option name="path" select="concat($path,'/',$name)"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>              &lt;p:with-option name="include-filter" select="$include-filter"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>              &lt;p:with-option name="depth" select="$depth - 1"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>            &lt;/cx:recursive-directory-list&gt;
<span class="linenumber"> 65</span><span class="linenumber-separator"> </span>          &lt;/p:when&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>          &lt;p:when test="p:value-available('exclude-filter')"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>            &lt;cx:recursive-directory-list&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>              &lt;p:with-option name="path" select="concat($path,'/',$name)"/&gt;
<span class="linenumber"> 70</span><span class="linenumber-separator"> </span>              &lt;p:with-option name="exclude-filter" select="$exclude-filter"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>              &lt;p:with-option name="depth" select="$depth - 1"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>            &lt;/cx:recursive-directory-list&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>          &lt;/p:when&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber"> 75</span><span class="linenumber-separator"> </span>          &lt;p:otherwise&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>            &lt;cx:recursive-directory-list&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>              &lt;p:with-option name="path" select="concat($path,'/',$name)"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>              &lt;p:with-option name="depth" select="$depth - 1"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>            &lt;/cx:recursive-directory-list&gt;
<span class="linenumber"> 80</span><span class="linenumber-separator"> </span>          &lt;/p:otherwise&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>        &lt;/p:choose&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;/p:when&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;p:otherwise&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	&lt;p:identity/&gt;
<span class="linenumber"> 85</span><span class="linenumber-separator"> </span>      &lt;/p:otherwise&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;/p:choose&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;/p:viewport&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/p:declare-step&gt;
</pre></div>

<p>The slightly convoluted <tt class="step">p:choose</tt> is a consequence of
limitations in how <tt class="function">p:value-available</tt> works;
see <span class="formatting-error">???</span>.</p>

</div></div><div class="refentry" id="p.error"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:error</tt></span></h2><p><span class="refname"><tt class="step">p:error</tt></span> — Causes an error.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:error</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">false</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">code</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                       </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">code-prefix</code><code>"</code><code>/&gt;</code><code>                                </code><code class="comment">&lt;!-- </code><span class="opt-type">NCName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">code-namespace</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:error</tt> step generates a dynamic error using the
specified error code.</p>

<p>If the <tt class="option">code</tt> value contains a colon, then
its value is interpreted as a QName and there must be an in-scope namespace
declaration for that prefix in the pipeline document. It is an error in this
case to specify either a <tt class="option">code-prefix</tt> or
<tt class="option">code-namespace</tt>.</p>

<p>This step uses the document provided on its input as the content
of the error raised. A <tt class="tag-element">c:errors</tt> document will be produced
on the error output port; it can be caught by a <tt class="tag-element">p:try</tt> just
like any other dynamic error.</p>

<p>The <tt class="port">result</tt> port on <tt class="step">p:error</tt> is purely for
authoring convenience (especially in the common case where a
<tt class="step">p:error</tt> occurs in the branch of a <tt class="step">p:choose</tt>).
The <tt class="step">p:error</tt> step must obey all the rules with respect to
its inputs and outputs even though the step is guaranteed to fail so
nothing will ever appear on its <tt class="port">result</tt> port.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>


<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.D0034.1"/><code>err:D0034</code></td><td style="">Occurs
if <tt class="option">code-prefix</tt> or <tt class="option">code-namespace</tt> are
used when the lexical value of the <tt class="option">code</tt> option contains
a colon.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>A <tt class="step">p:error</tt> always fails. In the example below, we
catch it with a <tt class="step">p:try</tt>.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:my-errors</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.example.org/error</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">try</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">group</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">error</tt><span class="pcdata"> </span><tt class="tag-attribute">code</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">my-errors:fall-down-go-bang</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span><span class="pcdata">Nothing to see here.</span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">error</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">group</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">catch</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">uh-oh</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">uh-oh</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">error</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">catch</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">try</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/error-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">errors</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">error</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:my-errors</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.example.org/error</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">           </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">!1.4.1.1</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">           </span><tt class="tag-attribute">type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">p:error</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">           </span><tt class="tag-attribute">code</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">my-errors:fall-down-go-bang</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span><span class="pcdata">Nothing to see here.</span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">error</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">errors</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Without the <tt class="step">p:try</tt>, the failure would have caused the
pipeline processor to abort the pipeline. How (or if) the processor reports
an error in that case is <em class="glossterm">implementation-defined</em>.
    </p>

</div></div><div class="refentry" id="p.escape-markup"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:escape-markup</tt></span></h2><p><span class="refname"><tt class="step">p:escape-markup</tt></span> — Escapes XML markup.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:escape-markup</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">cdata-section-elements</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">''</code><code>"</code><code>/&gt;</code><code>         </code><code class="comment">&lt;!-- </code><span class="opt-type">ListOfQNames</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">doctype-public</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">doctype-system</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">escape-uri-attributes</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>     </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">include-content-type</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>       </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">indent</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>                    </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">media-type</code><code>"</code><code>/&gt;</code><code>                                 </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">method</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'xml'</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">omit-xml-declaration</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>       </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">standalone</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'omit'</code><code>"</code><code>/&gt;</code><code>                 </code><code class="comment">&lt;!-- </code><span class="opt-type">"true" | "false" | "omit"</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">undeclare-prefixes</code><code>"</code><code>/&gt;</code><code>                         </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">version</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'1.0'</code><code>"</code><code>/&gt;</code><code>                     </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="code">p:escape-markup</tt> step serializes the children of
the document element of its source document and replaces those
children with their serialization. The result is a single element
with text content that represents the “escaped” syntax of the children
as they were serialized.</p>

<p>This step supports most of the standard serialization options;
these options control how the output markup is produced before it is
escaped. This step produces an XML document that contains the escaped
characters of the serialized representation, not an encoded octet
stream. The serialization options related to encoding characters
(<tt class="option">byte-order-mark</tt>, <tt class="option">encoding</tt>, and
<tt class="option">normalization-form</tt>) do not apply and cannot be used
on this step.</p>

<p>By default, this step does not generate an XML declaration in
the escaped result.</p>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>Some non-XML systems require markup to be escaped. This can
be achieved with the <tt class="step">p:escape-markup</tt> step.
    </p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">escape-markup</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/escape-markup-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">document</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">This is a paragraph of text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">So is this</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">document</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">document</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  <tt class="tag-genentity">&amp;lt;</tt>para<tt class="tag-genentity">&amp;gt;</tt>This is a paragraph of text.<tt class="tag-genentity">&amp;lt;</tt>/para<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  <tt class="tag-genentity">&amp;lt;</tt>para<tt class="tag-genentity">&amp;gt;</tt>So is this<tt class="tag-genentity">&amp;lt;</tt>/para<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">document</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Observe that <tt class="step">p:escape-markup</tt> <em>does not</em>
escape the document element of its input. It can't. If it did, the output of
the step would not be well-formed XML.</p><p>To encode an entire document, place it in a wrapper first.
The easiest way to do that is with <tt class="step">p:wrap-sequence</tt>.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap-sequence</tt><span class="pcdata"> </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">my-wrapper</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">escape-markup</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/escape-markup-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">document</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">This is a paragraph of text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">So is this</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;/</span><tt class="tag-localname">document</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">my-wrapper</tt><span class="msc">&gt;</span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>document<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  <tt class="tag-genentity">&amp;lt;</tt>para<tt class="tag-genentity">&amp;gt;</tt>This is a paragraph of text.<tt class="tag-genentity">&amp;lt;</tt>/para<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  <tt class="tag-genentity">&amp;lt;</tt>para<tt class="tag-genentity">&amp;gt;</tt>So is this<tt class="tag-genentity">&amp;lt;</tt>/para<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/document<tt class="tag-genentity">&amp;gt;</tt></span><span class="mso">&lt;/</span><tt class="tag-localname">my-wrapper</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Then in subsequent steps, such as <tt class="step">p:http-request</tt>, you
    can extract the contents of the wrapper, as necessary.</p>

</div></div><div class="refentry" id="p.exec"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:exec</tt></span></h2><p><span class="refname"><tt class="step">p:exec</tt></span> — Runs an external command.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:exec</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">errors</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">exit-status</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">command</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                    </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">args</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">''</code><code>"</code><code>/&gt;</code><code>                           </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">cwd</code><code>"</code><code>/&gt;</code><code>                                        </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">source-is-xml</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>              </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">result-is-xml</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>              </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">wrap-result-lines</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>         </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">errors-is-xml</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>             </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">wrap-error-lines</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>          </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">path-separator</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">failure-threshold</code><code>"</code><code>/&gt;</code><code>                          </code><code class="comment">&lt;!-- </code><span class="opt-type">integer</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">arg-separator</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">' '</code><code>"</code><code>/&gt;</code><code>                 </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">byte-order-mark</code><code>"</code><code>/&gt;</code><code>                            </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">cdata-section-elements</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">''</code><code>"</code><code>/&gt;</code><code>         </code><code class="comment">&lt;!-- </code><span class="opt-type">ListOfQNames</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">doctype-public</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">doctype-system</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">encoding</code><code>"</code><code>/&gt;</code><code>                                   </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">escape-uri-attributes</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>     </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">include-content-type</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>       </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">indent</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>                    </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">media-type</code><code>"</code><code>/&gt;</code><code>                                 </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">method</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'xml'</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">normalization-form</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'none'</code><code>"</code><code>/&gt;</code><code>         </code><code class="comment">&lt;!-- </code><span class="opt-type">NormalizationForm</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">omit-xml-declaration</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>       </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">standalone</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'omit'</code><code>"</code><code>/&gt;</code><code>                 </code><code class="comment">&lt;!-- </code><span class="opt-type">"true" | "false" | "omit"</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">undeclare-prefixes</code><code>"</code><code>/&gt;</code><code>                         </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">version</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'1.0'</code><code>"</code><code>/&gt;</code><code>                     </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:exec</tt> step runs an external command. It can pass
a document to the “standard input” of the command and it can return both
the command's “standard output” and “standard error” as XML documents.</p>

<p>The <tt class="step">p:exec</tt> step executes the command passed on
<tt class="option">command</tt> with the arguments passed on
<tt class="option">args</tt>. The processor does not interpolate the values
of the <tt class="option">command</tt> or <tt class="option">args</tt> (for example,
expanding references to environment variables).
</p>

<p>If <tt class="option">cwd</tt> is specified, then the current working
directory is changed to the value of that option before execution
begins. If <tt class="option">cwd</tt> is not specified, the current working
directory is <em class="glossterm">implementation-defined</em>.</p>

<p>Although the step is optional and therefore not guaranteed to be
portable, some care has been taken to address at least the most common
cross-platform issues: path and argument separators.</p>

<p>Unix-based systems us a forward slash to separate the components
of a path, for example <tt class="filename">/usr/bin/ls</tt>. On
Windows-based systems, the backward slash is used, for example:
<tt class="filename">\usr\bin\ls</tt>. Assuming that you want to run a
<tt class="step">p:exec</tt> step on both kinds of systems, and you've already
arranged for the actual path name of the command to be the same on
both systems, you couldn't easily write the <tt class="step">p:exec</tt> step
because no matter which character you chose, it would only work on one
of the systems.</p>

<p>XProc addresses this with a <tt class="option">path-separator</tt> option.
This option, which must be exactly one character, will be replaced in
<tt class="option">command</tt> and <tt class="option">args</tt> options with the
appropriate, platform-specific path separator character.</p>

<p>A similar problem exists for the command line arguments. It's
common to separate arguments with spaces. For example,
“<tt class="literal">a b c</tt>” is usually interpreted as three distinct
arguments, “<tt class="literal">a</tt>”, “<tt class="literal">b</tt>”, and
“<tt class="literal">c</tt>”.</p>

<p>A the same time, it's become quite common for filenames to contain
spaces. This leads to a dilemma. Given a file named
“<tt class="filename">My Report.xml</tt>”, how do I pass it to a command without
having it interpreted as two arguments: “<tt class="literal">My</tt>” and
“<tt class="literal">Report.xml</tt>”.</p>

<p>Command line tools usually get around this problem by introducing
various quoting mechanisms. Double quotes around the filename, for example,
tell the shell to recognize it as a single argument, and a backslash in front
of a character often causes it to be interpreted literally (allowing even
uncommon filenames like “<tt class="filename">My "report".xml</tt>” to be
processed).</p>

<p>XML already has its own notion of special characters and an
escaping mechanism for them, not a mechanism that can reasonably be
extended to cover this case. Adding <em>another</em>
mechanism for escaping characters in this context would have been
confusing. What's more, XProc doesn't really give the pipeline author
a convenient way to analyze the arguments, select an appropriate,
escaping mechanism, and use it. That's just not the sort of thing it's
made to do.</p>

<p>XProc attacks the problem a different way, it provides an
<tt class="option">arg-separator</tt> option, which defaults to a space. Every
occurrence of this character in the <tt class="option">args</tt> string is
interpreted as a separator between arguments. Using this mechanism, you can
pass filenames with special characters along with other arguments simply
by picking a different separator:</p>

<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;p:exec command="dosomething"
<span class="linenumber">   </span><span class="linenumber-separator"> </span>        arg-separator="!"
<span class="linenumber">   </span><span class="linenumber-separator"> </span>        args='-f!My "report".xml' …&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>…
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>&lt;/p:exec&gt;
</pre></div>

<p>This has one unfortunate consequence: if you separate arguments
with <em>multiple spaces</em>, each space gets interpreted
as a separator and you get empty strings as individual arguments which
is rarely what you want. Either pick an explicit separator character or
make sure you use only a single space between arguments.</p>

<div class="refsection"><div class="refsection-titlepage"><h4>Inputs and outputs</h4></div>


<p>The document that appears on the <tt class="port">source</tt> port is sent
to the command on “standard input”. The step is declared to allow a sequence
of documents to appear on <tt class="port">source</tt>, this is only to allow
the source to be an empty sequence. If an empty sequence appears on the
<tt class="port">source</tt> port, nothing is passed to standard input. It is an
error to send more than one document to the <tt class="port">source</tt> port.</p>

<p>There's no standard API for passing XML documents to external
commands, so they are sent as text. If the
<tt class="option">source-is-xml</tt> option is “<tt class="literal">true</tt>”,
then the source document is serialized with the serialization options
specified and that text is sent to the command. If
<tt class="option">source-is-xml</tt> option is “<tt class="literal">false</tt>”,
the XPath string-value of the document is passed.</p>

<p>The standard output of the command is read and returned on
<tt class="port">result</tt>; the standard error output is read and returned on
<tt class="port">errors</tt>. In order to assure that the result will be an
XML document, each of the results will be wrapped in a <tt class="tag-element">c:result</tt>
element.</p>

<p>If <tt class="option">result-is-xml</tt> is “<tt class="literal">true</tt>”,
the standard output of the program is assumed to be XML and will be
parsed as a single document. If it is false, the output will be
returned as escaped text.</p>

<p>If <tt class="option">wrap-result-lines</tt> is
“<tt class="literal">true</tt>”, a <tt class="tag-element">c:line</tt> element will be wrapped
around each line of output.</p>

<p>The same rules apply to the standard error output of the
program, with the <tt class="option">errors-is-xml</tt> and
<tt class="option">wrap-error-lines</tt> options, respectively.</p>

<p>If either of the results are XML, they are parsed using the same
rules that <tt class="tag-element">p:document</tt> uses.</p>

<p>The <tt class="port">exit-status</tt> port always returns a single
<tt class="tag-element">c:result</tt> element which contains the system exit status that
the process returned. The specific exit status values returned by
a process invoked with <tt class="step">p:exec</tt> are
<em class="glossterm">implementation-dependent</em>.</p>

<p>If a <tt class="option">failure-threshold</tt> value is supplied, and
the exit status is greater than that threshold, then the
<tt class="step">p:exec</tt> step will fail. This failure, like any step
failure, can be captured with a <tt class="tag-element">p:try</tt>.</p>
</div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0033"/><code>err:C0033</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs if the command cannot be run.
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0034"/><code>err:C0034</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the current working directory cannot be changed
to the value of the <tt class="option">cwd</tt> option.
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0063"/><code>err:C0063</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the <tt class="option">path-separator</tt> option is
specified and is not exactly one character long.
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0066"/><code>err:C0066</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if
the <tt class="option">arg-separator</tt> option is specified and is not
exactly one character long.
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.D0006"/><code>err:D0006</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs if more than one document appears on the
<tt class="port">source</tt> port of the <tt class="step">p:exec</tt> step.
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0035"/><code>err:C0035</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if both
<tt class="option">result-is-xml</tt> and <tt class="option">wrap-result-lines</tt> or
<tt class="option">error-is-xml</tt> and <tt class="option">wrap-error-lines</tt>
are specified
</td></tr><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0064"/><code>err:C0064</code></td><td style="">Occurs
if the exit code from the command is greater than
the specified <tt class="option">failure-threshold</tt> value.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>The optional <tt class="step">p:exec</tt> step runs external processes.
    </p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">exec</tt><span class="pcdata"> </span><tt class="tag-attribute">command</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/bin/cat</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">result-is-xml</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/exec-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="add"><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="add"><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Many processes produce non-XML markup, which has to be encoded.
    In this case, the external process does not expect any input, so we
    explicitly make the <tt class="port">source</tt> empty.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">exec</tt><span class="pcdata"> </span><tt class="tag-attribute">command</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/bin/ls</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">result-is-xml</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">false</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">args</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">-l ../docs</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">empty</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">exec</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/exec-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span><span class="pcdata">total 72</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">drwxr-xr-x  4 ndw  ndw   136 Apr  5 07:00 apps</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">drwxr-xr-x  5 ndw  ndw   170 Apr  5 07:00 chaps</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">-rw-r--r--  1 ndw  ndw    93 Mar 31 11:49 document.xml</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">-rw-r--r--  1 ndw  ndw  1490 Apr  6 08:46 document.xsd</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">-rw-r--r--  1 ndw  ndw  1421 Apr  6 08:34 document.xsd~</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">-rw-r--r--  1 ndw  ndw     0 Apr  1 08:55 funny<tt class="tag-genentity">&amp;amp;</tt>name.txt</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">-rw-r--r--  1 ndw  ndw    99 Apr  6 07:53 grammar.rnc</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">-rw-r--r--  1 ndw  ndw   484 Apr  6 07:47 grammar.rng</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">-rw-r--r--  1 ndw  ndw   104 Apr  2 12:10 invalid.xml</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">-rw-r--r--  1 ndw  ndw   200 Mar 30 20:37 main.xml</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">-rw-r--r--  1 ndw  ndw   551 Apr  6 08:06 rules.sch</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">-rw-r--r--  1 ndw  ndw    94 Apr  2 12:09 valid.xml</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>The <tt class="option">wrap-result-lines</tt> option can make it
easier for other XML processes to work with the lines of non-XML output.
    </p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">exec</tt><span class="pcdata"> </span><tt class="tag-attribute">command</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/bin/ls</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">result-is-xml</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">false</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">args</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">-l ../docs</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">wrap-result-lines</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">empty</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">exec</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/exec-3.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">total 72</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">drwxr-xr-x  4 ndw  ndw   136 Apr  5 07:00 apps</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">drwxr-xr-x  5 ndw  ndw   170 Apr  5 07:00 chaps</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">-rw-r--r--  1 ndw  ndw    93 Mar 31 11:49 document.xml</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">-rw-r--r--  1 ndw  ndw  1490 Apr  6 08:46 document.xsd</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">-rw-r--r--  1 ndw  ndw  1421 Apr  6 08:34 document.xsd~</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">-rw-r--r--  1 ndw  ndw     0 Apr  1 08:55 funny<tt class="tag-genentity">&amp;amp;</tt>name.txt</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">-rw-r--r--  1 ndw  ndw    99 Apr  6 07:53 grammar.rnc</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">-rw-r--r--  1 ndw  ndw   484 Apr  6 07:47 grammar.rng</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">-rw-r--r--  1 ndw  ndw   104 Apr  2 12:10 invalid.xml</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">-rw-r--r--  1 ndw  ndw   200 Mar 30 20:37 main.xml</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">-rw-r--r--  1 ndw  ndw   551 Apr  6 08:06 rules.sch</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span><span class="pcdata">-rw-r--r--  1 ndw  ndw    94 Apr  2 12:09 valid.xml</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">line</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>The exit status is available through the non-primary
“<tt class="port">exit-status</tt>” port.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">exec</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ls</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">command</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/bin/ls</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">result-is-xml</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">false</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">args</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">-l ../docs</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">wrap-result-lines</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">empty</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">exec</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">sink</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ls</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">exit-status</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/exec-4.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span><span class="pcdata">0</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Because it's an error to leave a primary output port unbound,
in this example we explicitly discard it with <tt class="step">p:sink</tt>. In
a real pipeline, we'd probably be doing something useful with the output.</p>

</div></div><div class="refentry" id="p.filter"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:filter</tt></span></h2><p><span class="refname"><tt class="step">p:filter</tt></span> — Filters documents with a dynamically constructed select expression.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:filter</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">select</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                     </code><code class="comment">&lt;!-- </code><span class="opt-type">XPathExpression</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="code">p:filter</tt> step selects portions of the source document
based on a dynamically constructed XPath select expression.</p>

<p>This step behaves just like an <tt class="step">p:identity</tt> step with
a <tt class="tag-element">p:input</tt> that has a <tt class="tag-attribute">select</tt>
expression except that the select expression is computed
dynamically.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>In this example, we select the element with a particular
<tt class="tag-attribute">xml:id</tt> where the ID value is an option to the pipeline.
    </p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">id</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'two'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">filter</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">with-option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">select</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">concat('//*[@xml:id=<tt class="tag-numcharref">&amp;#34;</tt>',$id,'<tt class="tag-numcharref">&amp;#34;</tt>]')</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">filter</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/filter-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">one</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">One</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">two</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Two</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">three</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Three</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">one</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">One</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">two</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Two</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">three</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Three</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>In real life it's unlikely that there would be value in having
   a default for the 'id' option, but it's convenient for the example.)
    </p>

</div></div><div class="refentry" id="p.hash"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:hash</tt></span></h2><p><span class="refname"><tt class="step">p:hash</tt></span> — Computes a cryptographic hash and inserts it into a document.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:hash</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">parameters</code><code>"</code> <code class="attr kind-attr">kind</code><code>="</code><code class="value kind-value">parameter</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">value</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">algorithm</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                  </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">version</code><code>"</code><code>/&gt;</code><code>                                    </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:hash</tt> step generates a hash, or digital “fingerprint”,
for some value and inserts it into the <tt class="port">source</tt> document at
specified location(s).</p>

<p>The <tt class="option">algorithm</tt> identifies the kind of hash to
generate. Standard values are
“<tt class="literal">crc</tt>”, “<tt class="literal">md</tt>”, and “<tt class="literal">sha</tt>”.
Implementations may support additional values as well.</p>

<p>If a <tt class="tag-attribute">version</tt> is not specified, the
default version is algorithm-defined. For “<tt class="literal">crc</tt>” it
is 32, for “<tt class="literal">md</tt>” it is 5, for “<tt class="literal">sha</tt>”
it is 1.</p>

<p>A hash is constructed from the string specified in the
<tt class="option">value</tt> option using the specified algorithm and
version. The resulting hash is usually returned as a string of
hexadecimal characters.
</p>

<p>Each matching node in the source document is replaced by the
computed hash (if more than one node matches, the
<em>same</em> hash value is used as the replacement
each time). If the matched node is an attribute, then the computed hash
is used as the new attribute value, in all other cases, the entire node
is replaced.</p>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0036"/><code>err:C0036</code></td><td style="">Occurs
if the requested hash algorithm is not
one that the processor understands or if the value or parameters are
not appropriate for that algorithm.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>The FOAF (“friend of a friend”) project specifies an
SHA1 checksum as an alternative for email addresses (so that the addresses
can't be harvested by spammers).</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:rdf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/02/22-rdf-syntax-ns#</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:foaf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://xmlns.com/foaf/0.1/</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">hash</tt><span class="pcdata"> </span><tt class="tag-attribute">algorithm</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">sha</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/*/foaf:mbox_sha1sum/node()</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">with-option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">value</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/*/foaf:mbox/@rdf:resource</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">hash</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/hash-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">Person</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:foaf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://xmlns.com/foaf/0.1/</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">             </span><span class="nsdecl"><tt class="tag-attribute">xmlns:rdf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/02/22-rdf-syntax-ns#</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">             </span><tt class="tag-attribute">rdf:about</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://norman.walsh.name/knows/who#norman-walsh</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">name</tt><span class="msc">&gt;</span><span class="pcdata">Norman Walsh</span><span class="mso">&lt;/</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">name</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">nick</tt><span class="msc">&gt;</span><span class="pcdata">norm</span><span class="mso">&lt;/</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">nick</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">nick</tt><span class="msc">&gt;</span><span class="pcdata">ndw</span><span class="mso">&lt;/</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">nick</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">nick</tt><span class="msc">&gt;</span><span class="pcdata">nwalsh</span><span class="mso">&lt;/</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">nick</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">mbox</tt><span class="pcdata"> </span><tt class="tag-attribute">rdf:resource</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">mailto:ndw@nwalsh.com</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">mbox_sha1sum</tt><span class="msc">&gt;</span><span class="pcdata">@@</span><span class="mso">&lt;/</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">mbox_sha1sum</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">Person</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">Person</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:foaf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://xmlns.com/foaf/0.1/</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">             </span><span class="nsdecl"><tt class="tag-attribute">xmlns:rdf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/02/22-rdf-syntax-ns#</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">             </span><tt class="tag-attribute">rdf:about</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://norman.walsh.name/knows/who#norman-walsh</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">name</tt><span class="msc">&gt;</span><span class="pcdata">Norman Walsh</span><span class="mso">&lt;/</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">name</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">nick</tt><span class="msc">&gt;</span><span class="pcdata">norm</span><span class="mso">&lt;/</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">nick</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">nick</tt><span class="msc">&gt;</span><span class="pcdata">ndw</span><span class="mso">&lt;/</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">nick</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">nick</tt><span class="msc">&gt;</span><span class="pcdata">nwalsh</span><span class="mso">&lt;/</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">nick</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">mbox</tt><span class="pcdata"> </span><tt class="tag-attribute">rdf:resource</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">mailto:ndw@nwalsh.com</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">mbox_sha1sum</tt><span class="msc">&gt;</span><span class="pcdata">9f5c771a25733700b2f96af4f8e6f35c9b0ad327</span><span class="mso">&lt;/</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">mbox_sha1sum</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">foaf</tt><span class="colon">:</span><tt class="tag-localname">Person</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.http-request"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:http-request</tt></span></h2><p><span class="refname"><tt class="step">p:http-request</tt></span> — Interact with other systems over HTTP.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:http-request</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">byte-order-mark</code><code>"</code><code>/&gt;</code><code>                            </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">cdata-section-elements</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">''</code><code>"</code><code>/&gt;</code><code>         </code><code class="comment">&lt;!-- </code><span class="opt-type">ListOfQNames</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">doctype-public</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">doctype-system</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">encoding</code><code>"</code><code>/&gt;</code><code>                                   </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">escape-uri-attributes</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>     </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">include-content-type</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>       </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">indent</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>                    </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">media-type</code><code>"</code><code>/&gt;</code><code>                                 </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">method</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'xml'</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">normalization-form</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'none'</code><code>"</code><code>/&gt;</code><code>         </code><code class="comment">&lt;!-- </code><span class="opt-type">NormalizationForm</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">omit-xml-declaration</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>       </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">standalone</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'omit'</code><code>"</code><code>/&gt;</code><code>                 </code><code class="comment">&lt;!-- </code><span class="opt-type">"true" | "false" | "omit"</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">undeclare-prefixes</code><code>"</code><code>/&gt;</code><code>                         </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">version</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'1.0'</code><code>"</code><code>/&gt;</code><code>                     </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="code">p:http-request</tt> step allows you to interact with
other systems over HTTP. You describe the interaction that you want to have
with the system in the form of a <tt class="tag-element">c:request</tt> document sent to the
<tt class="port">source</tt> input port. The response that comes back from the
system is returned in the <tt class="port">result</tt> port. The step provides
a lot of flexibility in how the response is presented.</p>

<p>This step is actually quite complicated because it attempts to
provide a uniform interface to all of the possible HTTP methods, with
and without authentication, and to handle sending and receiving both
single and multipart message bodies that may or may not be
XML.</p>

<p>Don't let the all of the possible complexity persuade you into thinking
that it has to be complex. Here's a simple example that retrieves the
XProc specification from the W3C website:</p>

<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>  &lt;p:http-request&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:input port="source"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;p:inline&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>        &lt;c:request method="GET"
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>                   href="http://www.w3.org/TR/xproc/langspec.xml"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;/p:inline&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;/p:input&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;/p:http-request&gt;
</pre></div>

<p>If most of your web interactions are simple HTTP “GET” requests, it
may be useful to write a wrapper that provides direct support for those
simple cases. In the examples below, you'll find a <tt class="step">cx:http-get</tt>
pipeline that simplifies the above example to a single line:</p>

<div class="programlisting"><pre>&lt;cx:http-get href="http://www.w3.org/TR/xproc/langspec.xml"/&gt;
</pre></div>

<p>Now let's look at the step in all it's generality. Everything begins
with the request. A <tt class="tag-element">c:request</tt> element has the following form:</p>

<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;c:request
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  method = NCName
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  href? = anyURI
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  username? = string
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>  password? = string
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  auth-method? = string
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  send-authorization? = boolean
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  override-content-type? = string
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  detailed? = boolean
<span class="linenumber"> 10</span><span class="linenumber-separator"> </span>  status-only? = boolean&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    (c:header*, (c:body | c:multipart)?)
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/c:request&gt;
</pre></div>

<p>The <tt class="tag-attribute">method</tt> attribute must be one of the HTTP methods
(one of the methods supported by the system with which you're
interacting). The <tt class="tag-attribute">href</tt> attribute identifies the URI that you want to
interact with. The <tt class="tag-attribute">username</tt>, <tt class="tag-attribute">password</tt>,
<tt class="tag-attribute">auth-method</tt>, and <tt class="tag-attribute">send-authorization</tt> attributes
control authentication, see <a href="#http-auth" title="HTTP Authentication">the section called “HTTP Authentication”</a>, below. The
<tt class="tag-attribute">override-content-type</tt> attribute allows you to change the
interpretation of the result; the <tt class="tag-attribute">detailed</tt> and
<tt class="tag-attribute">status-only</tt> attributes control how much detail is exposed
in the result, see <a href="#c.request_response" title="Interpreting the response">the section called “Interpreting the response”</a>, also below.</p>

<p>The content of the <tt class="tag-element">c:request</tt> consists of any number
of <tt class="tag-element">c:header</tt> elements, followed optionally by a
<tt class="tag-element">c:body</tt> or a <tt class="tag-element">c:multipart</tt>.
</p>

<p>A <tt class="tag-element">c:header</tt> element allows you to send additional HTTP
headers with the request:</p>

<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;c:header
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  name = string
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  value = string /&gt;
</pre></div>

<p>The <tt class="tag-attribute">name</tt> and <tt class="tag-attribute">value</tt> attributes specify the name
and value of the header, respectively. As we'll see below, the
<tt class="tag-element">c:header</tt> element is also used to present the headers that
the server sends back.</p>

<p>If you're doing an HTTP “GET”, then you don't send any content to the
server, but for HTTP “POST” or “PUT” requests (among others), data is sent
to the server using a <tt class="tag-element">c:body</tt> or <tt class="tag-element">c:multipart</tt>
elements.</p>

<p>The HTTP request is formulated from the elements in the request
and transmitted to the host specified by the <tt class="code">href</tt>
attribute.</p>

<div class="refsection" id="c.request_body"><div class="refsection-titlepage"><h4>Formulating the request</h4></div>


<p>The <tt class="tag-element">c:body</tt> element holds the body (or in the case of
a <a href="#multipart-requests">multipart message</a>, each of the
body parts) of the message:</p>

<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;c:body
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  content-type = string
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  encoding? = string
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  id? = string
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>  description? = string&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    <em>any content</em>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/c:body&gt;
</pre></div>

<p>The <tt class="code">content-type</tt> attribute specifies the media type
of the body or body part, for example, “<tt class="literal">application/xml</tt>”
“<tt class="literal">text/plain</tt>”, or “<tt class="literal">image/png</tt>”. In
HTTP terms, this is the value used for the
<tt class="literal"><a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17">Content-Type</a></tt>
header. The <tt class="tag-attribute">encoding</tt> is used for images and other non-text types, see
<a href="#binary-types" title="Binary content">the section called “Binary content”</a>, below.</p>

<p>In some applications, usually multipart requests, it may be useful or
necessary to specify a
<tt class="literal"><a href="http://www.apps.ietf.org/rfc/rfC1521.html#sec-6.1">Content-ID</a></tt>
or
<tt class="literal"><a href="http://www.apps.ietf.org/rfc/rfc1521.html#sec-6.2">Content-Description</a></tt> in the request. You can specify these values with the
<tt class="tag-attribute">id</tt> and <tt class="tag-attribute">description</tt> attributes, respectively.</p>

<p>After establishing the headers for a request body, the processor
has to actually package it up for transmission to the server. Exactly
how this packaging is done depends on the <tt class="tag-attribute">content-type</tt>
specified.</p>

<div class="itemizedlist"><ul><li><p>If the content type specifies an XML media type, then the body
is serialized using the options specified on the
<tt class="step">p:http-request</tt> and the resulting serialized form is sent
to the server. In other words, if the body is XML, the processor does
what you'd expect to send the XML over the wire.</p></li><li><p>If the content type does not specify an XML media type, or if an
<tt class="tag-attribute">encoding</tt> is specified, then the content of the <tt class="tag-element">c:body</tt>
element is sent directly. In this case, you must have constructed the
<tt class="tag-element">c:body</tt> so that it contains exactly, and only, the characters
that you want sent. In other words, you have to encode it before you
put it in the <tt class="tag-element">c:body</tt> element.</p></li></ul></div>

<div class="refsection" id="multipart-requests"><div class="refsection-titlepage"><h5>Multipart requests</h5></div>


<p>Sometimes you want to send more than a single document to the server.
Some systems address this by specifying a specific packaging system, such
as sending a single ZIP file containing all the parts, but other systems
use “<a href="http://www.apps.ietf.org/rfc/rfc1521.html#sec-7.2">multipart
MIME</a>” for the packaging.
In <tt class="step">p:http-request</tt> this is supported through the use
of the <tt class="tag-element">c:multipart</tt> element:</p>

<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;c:multipart
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  content-type = string
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  boundary = string&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    c:body+
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>&lt;/c:multipart&gt;
</pre></div>

<p>The <tt class="tag-attribute">content-type</tt> specified must be a multipart media
type. If it's not specified, a value of
“<tt class="literal">multipart/mixed</tt>” is used.</p>

<p>In the request sent to the server, all of the parts are sent in
a single stream. The boundaries between each part are identified with
a boundary string. It's your responsibility to specify the
<tt class="tag-attribute">boundary</tt> string and it's critically important that you
specify a value that <em>will not</em> occur in the
(possibly encoded) representations of any of the parts.</p>

<p>Each individual <tt class="tag-element">c:body</tt> part is handled as described
above.</p>
</div>
</div>

<div class="refsection" id="c.request_response"><div class="refsection-titlepage"><h4>Interpreting the response</h4></div>


<p>How the processor interprets the part (or parts) that are
returned depends critically on the value of the content type header
that the server sends. A content type of
“<tt class="literal">application/xml</tt>” is naturally going to be
processed quite differently than a content type of
“<tt class="literal">image/png</tt>”. If the <tt class="tag-element">c:request</tt> specifies
an <tt class="tag-attribute">override-content-type</tt>, then that value is used to
determine how the part (or parts) are interpreted. Even if an override
is specified, however, the actual content type sent by the server will
be presented in the <tt class="tag-element">c:header</tt>, if there is one.</p>

<p>In the discussion below, “content type” refers to the content
type that the processor is using, either the one the server sent or
the one the request specified, as appropriate.</p>

<p>If you make an HTTP request, your presumably expecting some sort
of response. Sometimes you need to be able check the status code,
inspect the headers, interrogate the relationships between the parts,
etc.</p>

<p>In this case, you want the response to include all of the detail
that it can. The XProc processor provides this in the form of a
<tt class="tag-element">c:response</tt> element:</p>

<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;c:response
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  status? = integer&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    (c:header*, (c:body | c:multipart)?)
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/c:response&gt;
</pre></div>

<p>The response's status code is encoded in the <tt class="code">status</tt>
attribute and the headers and entity body are returned in
<tt class="tag-element">c:header</tt> and <tt class="tag-element">c:multipart</tt> or <tt class="tag-element">c:body</tt>
content.</p>

<p>But often, you know that you're going to get back, for example,
a single XML document. If you expect the step to succeed and you just
want the document back, it's tedious to have to remember to unpack it
from inside the <tt class="tag-element">c:response</tt> wrapper every time. To alleviate
this tedium, the <tt class="tag-element">c:request</tt> allows you to specify whether or
not you want a “detailed” response:</p>

<div class="itemizedlist"><ul><li><p>If <tt class="tag-attribute">detailed</tt> is “<tt class="literal">true</tt>”, you get
back a <tt class="tag-element">c:response</tt> element containing all the headers and
the body or bodies.</p></li><li><p>If <tt class="tag-attribute">detailed</tt> is not specified or is explicitly
“<tt class="literal">false</tt>”, the body (or each of the bodies) is
converted into an XML representation and returned.</p></li></ul></div>

<p>In other words, you can get all the detail if you want, but the
default is just to return the document (or sequence of documents) that
the server sends back in its response.</p>

<p>The output of a <tt class="step">p:http-request</tt> must be XML, so the
body (or each of the bodies) has to be converted into an XML
representation. For media types (images, binaries, etc.) that can't be
represented as a sequence of Unicode characters, the response is
<tt class="literal">base64</tt> encoded and then returned in a
<tt class="tag-element">c:body</tt> element. If the content is base64-encoded, the
<tt class="tag-attribute">encoding</tt> attribute on <tt class="tag-element">c:body</tt> will
be set to “<tt class="literal">base64</tt>”.</p>

<p>If the media type isn't XML but can be represented as a sequence
of Unicode characters, the content of the
<tt class="tag-element">c:body</tt> element will be those characters. In this case,
there will be no <tt class="tag-attribute">encoding</tt> attribute on the <tt class="tag-element">c:body</tt>.</p>

<p>If the response is an XML media type, the content of the
constructed <tt class="tag-element">c:body</tt> element is the result of decoding the
body as necessary, then parsing it with an XML parser. If the content
is not well-formed, the step fails.</p>

<p>In the case of a multipart response, the same rules apply when
constructing a <tt class="tag-element">c:body</tt> element for each body part
encountered.</p>

<p>There's one more special case. If the <tt class="tag-attribute">status-only</tt>
attribute on the <tt class="tag-element">c:request</tt> is “<tt class="literal">true</tt>”,
the result document will always be a <tt class="tag-element">c:response</tt> containing
only header information. The response will not be processed to produce
a <tt class="tag-element">c:body</tt> or <tt class="tag-element">c:multipart</tt> element at all.</p>
</div>

<div class="refsection" id="http-auth"><div class="refsection-titlepage"><h4>HTTP Authentication</h4></div>


<p>Several attributes on the <tt class="tag-element">c:request</tt> control if
and how authentication is performed.</p>

<p>If the <tt class="tag-attribute">username</tt> attribute is specified, the
<tt class="tag-attribute">username</tt>, <tt class="tag-attribute">password</tt>,
<tt class="tag-attribute">auth-method</tt>, and <tt class="tag-attribute">send-authorization</tt>
attributes are used to handle authentication according to the selected
authentication method.</p>

<p>The <tt class="tag-attribute">username</tt> and <tt class="tag-attribute">password</tt> specify the
authentication credentials of the user. The <tt class="tag-attribute">auth-method</tt>
specifies the expected authentication method. If the
authentication method is “<tt class="literal">Basic</tt>” or
“<tt class="literal">Digest</tt>”, authentication is handled as per
<span class="formatting-error">???</span>. Other values are allowed, but their
meaning is <em class="glossterm">implementation-defined</em>.</p>

<p>Authentication generally requires several messages sent back and forth
between the client and the server. The client requests access, the server
responds with a challenge, the client replies with appropriate credentials,
and then the server sends back the actual response. If you're using
basic authentication, you can avoid one round trip by setting
<tt class="tag-attribute">send-authentication</tt> to “<tt class="literal">true</tt>”. If you do,
the credentials are sent on the first request. This only works for
basic authentication, however, because other methods require information
from the challenge to construct the credentials.</p>
</div>

<div class="refsection" id="other-protocols"><div class="refsection-titlepage"><h4>Supporting other protocols</h4></div>


<p>In the case of simple “GET” requests, implementors are
encouraged to support as many protocols as practical. In particular,
pipeline authors may attempt to use <tt class="tag-element">p:http-request</tt> to load
documents with computed URIs using the <tt class="literal">file:</tt>
scheme.</p>

</div>

<div class="refsection" id="binary-types"><div class="refsection-titlepage"><h4>Binary content</h4></div>


<p>Several steps use “base64” encoding to transmit binary data
through an XProc pipeline. The <tt class="tag-attribute">encoding</tt> attribute controls
the decoding of the element content for formulating the request.</p>

<p>A value of “<tt class="literal">base64</tt>” indicates the element's
content is a base64 encoded string whose byte stream should be sent as
the message body. An implementation may support encodings other than
<tt class="literal">base64</tt> but these encodings and their names are
<em class="glossterm">implementation-defined</em>.</p>
</div>

<div class="refsection" id="cookies"><div class="refsection-titlepage"><h4>Cookies</h4></div>


<p>With one exception, in version 1.0 of XProc, the
<tt class="tag-element">p:http-request</tt> step does not provide any standard
mechanisms for managing cookies. Pipeline authors that need to
preserve cookies across several <tt class="tag-element">p:http-request</tt> calls in the
same pipeline or across multiple invocations of the same or different
pipelines will have to rely on
<em class="glossterm">implementation-defined</em> mechanisms.
</p>

<p>The exception arises in the case of redirection. If a redirect
response includes cookies, those cookies are forwarded as appropriate
to the redirected location when the redirection is followed.</p>

<p>This behavior allows the <tt class="tag-element">p:http-request</tt> step to
interoperate with web services that use cookies as part of an
authentication protocol.</p>
</div>

<div class="refsection" id="html"><div class="refsection-titlepage"><h4>HTML content</h4></div>


<p>HTML isn't always (in fact, rarely is) well-formed XML. But it
can be represented in Unicode, so by the rules in <a href="#c.request_response" title="Interpreting the response">the section called “Interpreting the response”</a>, any content identified as
<tt class="code">text/html</tt> will be encoded as (escaped) text or
base64-encoded in the <tt class="tag-element">c:body</tt> element.
</p>

<p>If you want to treat the HTML content as XML, you can attempt to
convert it into XML using the <tt class="tag-element">p:unescape-markup</tt>
step.</p>
</div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0040"/><code>err:C0040</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the document element of the document that arrives on the
<tt class="port">source</tt> port is not <tt class="tag-element">c:request</tt>.
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0006"/><code>err:C0006</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the
<tt class="tag-attribute">method</tt> is not specified on a <tt class="tag-element">c:request</tt>.

</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0005"/><code>err:C0005</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the
request contains a <tt class="tag-element">c:body</tt> or <tt class="tag-element">c:multipart</tt> but the
<tt class="tag-attribute">method</tt> does not allow for an entity body being sent with the request.
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0004"/><code>err:C0004</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the
<tt class="code">status-only</tt> attribute has the value <tt class="literal">true</tt> and
the <tt class="code">detailed</tt> attribute does not have the value <tt class="literal">true</tt>.
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0003"/><code>err:C0003</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if a <tt class="option">username</tt>
or <tt class="option">password</tt> is specified without specifying an
<tt class="option">auth-method</tt>, if
the requested
<tt class="option">auth-method</tt> isn't supported, or the authentication
challenge contains an authentication method that isn't
supported.
</td></tr><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0020"/><code>err:C0020</code></td><td style="">Occurs
if the the user specifies a value
or values that are inconsistent with each other or with the requirements
of the step or protocol.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>Most of the examples in this section interact with small web services
hosted at <a href="http://tests.xproc.org/">http://tests.xproc.org/</a>. These services were
designed to help test various aspects of the <tt class="step">p:http-request</tt> step.
As such, they tend to be small and simple, if not particularly useful.</p>

<p>This example does a simple “get”.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/service/fixed-xml</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">get</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-01.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Sample document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Hello world!</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>This example does a “post”. The web service always returns the
same fixed RDF.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/service/fixed-rdf</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">post</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="pcdata"> </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">application/xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">any-content</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-02.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">rdf</tt><span class="colon">:</span><tt class="tag-localname">RDF</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:rdf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/02/22-rdf-syntax-ns#</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">         </span><span class="nsdecl"><tt class="tag-attribute">xmlns:dc</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://purl.org/dc/elements/1.1/</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">rdf</tt><span class="colon">:</span><tt class="tag-localname">Description</tt><span class="pcdata"> </span><tt class="tag-attribute">rdf:about</tt><span class="atteq">=</span><span class="attq">"</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">dc</tt><span class="colon">:</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Hello world!</span><span class="mso">&lt;/</span><tt class="tag-prefix">dc</tt><span class="colon">:</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">rdf</tt><span class="colon">:</span><tt class="tag-localname">Description</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">rdf</tt><span class="colon">:</span><tt class="tag-localname">RDF</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>This example is like the previous, except that the web service
returns plain text.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/service/fixed-text</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">post</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="pcdata"> </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">application/xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">any-content</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-03.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">text/plain; charset=<tt class="tag-numcharref">&amp;#34;</tt>utf-8<tt class="tag-numcharref">&amp;#34;</tt></span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Hello world!</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>This example also does a “post”, but it gets back binary.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/service/fixed-binary</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">post</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="pcdata"> </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">application/xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">any-content</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">string-replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/c:body/text()</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                    </span><tt class="tag-attribute">replace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'… base64-binary-content-elided …'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-04.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">image/png</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><tt class="tag-attribute">encoding</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">base64</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">… base64-binary-content-elided …</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>This example shows a <tt class="tag-element">c:multipart</tt> result.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/service/fixed-multipart</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">get</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">string-replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match="c:body[@encoding</tt><span class="atteq">=</span><span class="attq">'</span><span class="attvalue">base64</span><span class="attq">'</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">                    </span><tt class="tag-attribute">replace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'… base64-binary-content-elided …'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-05.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">multipart</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">             </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">multipart/related; boundary=<tt class="tag-numcharref">&amp;#34;</tt>=-=-=-=-=<tt class="tag-numcharref">&amp;#34;</tt></span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">             </span><tt class="tag-attribute">boundary</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">=-=-=-=-=</span><span class="attq">"</span><span class="msc">&gt;</span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="pcdata"> </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">text/html</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>html xmlns='http://www.w3.org/1999/xhtml'<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>head<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>title<tt class="tag-genentity">&amp;gt;</tt>Hello world!<tt class="tag-genentity">&amp;lt;</tt>/title<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/head<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>body<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>h1<tt class="tag-genentity">&amp;gt;</tt><tt class="tag-genentity">&amp;lt;</tt>img src='helloworld.png' alt='Hello World!' /<tt class="tag-genentity">&amp;gt;</tt><tt class="tag-genentity">&amp;lt;</tt>/h1<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>This is a hello world document.<tt class="tag-genentity">&amp;lt;</tt>/p<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/body<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/html<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span><span class="pcdata">… base64-binary-content-elided …</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">multipart</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>This example posts to an “echo” service that just sends back whatever
it receives.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap-sequence</tt><span class="pcdata"> </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">c:body</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">add-attribute</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/c:body</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">attribute-name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">content-type</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">attribute-value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">application/xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap-sequence</tt><span class="pcdata"> </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">c:request</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">set-attributes</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/c:request</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">attributes</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">dummy</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/service/echo</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">               </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">post</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">set-attributes</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-06.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">This is what gets sent.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">This is what gets sent.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>As you can see, we use other XProc steps to build up the request
wrapper for <tt class="step">p:http-request</tt>.</p><p>Here's an alternative way to construct the
<tt class="step">c:request</tt> document:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">insert</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/c:request/c:body</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">position</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">first-child</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/service/echo</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">post</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="pcdata"> </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">application/xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">insert</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-07.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">This is what gets sent.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">This is what gets sent.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Here we attempt and fail to connect to a password-protected
web service.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/docs/basic-auth</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">get</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-08.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">text/html; charset=<tt class="tag-numcharref">&amp;#34;</tt>iso-8859-1<tt class="tag-numcharref">&amp;#34;</tt></span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>html<tt class="tag-genentity">&amp;gt;</tt><tt class="tag-genentity">&amp;lt;</tt>head<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>title<tt class="tag-genentity">&amp;gt;</tt>401 Authorization Required<tt class="tag-genentity">&amp;lt;</tt>/title<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/head<tt class="tag-genentity">&amp;gt;</tt><tt class="tag-genentity">&amp;lt;</tt>body<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>h1<tt class="tag-genentity">&amp;gt;</tt>Authorization Required<tt class="tag-genentity">&amp;lt;</tt>/h1<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>This server could not verify that you</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">are authorized to access the document</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">requested.  Either you supplied the wrong</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">credentials (e.g., bad password), or your</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">browser doesn't understand how to supply</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">the credentials required.<tt class="tag-genentity">&amp;lt;</tt>/p<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>Additionally, a 404 Not Found</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">error was encountered while trying to use an ErrorDocument to handle the request.<tt class="tag-genentity">&amp;lt;</tt>/p<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/body<tt class="tag-genentity">&amp;gt;</tt><tt class="tag-genentity">&amp;lt;</tt>/html<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Unfortunately, the results aren't very useful. By specifying
<tt class="tag-attribute">detailed</tt>, we can get more information:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/docs/basic-auth</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">get</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">detailed</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-09.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">response</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">status</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">401</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Date</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Wed, 14 Apr 2010 12:15:54 GMT</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Server</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Apache</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">WWW-Authenticate</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Basic realm=<tt class="tag-numcharref">&amp;#34;</tt>TestAuthentication<tt class="tag-numcharref">&amp;#34;</tt></span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Vary</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Accept-Encoding</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Content-Length</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">520</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Content-Type</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">text/html; charset=iso-8859-1</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="pcdata"> </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">text/html; charset=<tt class="tag-numcharref">&amp;#34;</tt>iso-8859-1<tt class="tag-numcharref">&amp;#34;</tt></span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>html<tt class="tag-genentity">&amp;gt;</tt><tt class="tag-genentity">&amp;lt;</tt>head<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>title<tt class="tag-genentity">&amp;gt;</tt>401 Authorization Required<tt class="tag-genentity">&amp;lt;</tt>/title<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/head<tt class="tag-genentity">&amp;gt;</tt><tt class="tag-genentity">&amp;lt;</tt>body<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>h1<tt class="tag-genentity">&amp;gt;</tt>Authorization Required<tt class="tag-genentity">&amp;lt;</tt>/h1<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>This server could not verify that you</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">are authorized to access the document</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">requested.  Either you supplied the wrong</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">credentials (e.g., bad password), or your</span></span></div><div class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">browser doesn't understand how to supply</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">the credentials required.<tt class="tag-genentity">&amp;lt;</tt>/p<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>Additionally, a 404 Not Found</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">error was encountered while trying to use an ErrorDocument to handle the request.<tt class="tag-genentity">&amp;lt;</tt>/p<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/body<tt class="tag-genentity">&amp;gt;</tt><tt class="tag-genentity">&amp;lt;</tt>/html<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber"> 25</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">response</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Now at least we can see the status code.</p><p>If you want simply to test whether or not you can access a resource,
specifying both <tt class="tag-attribute">detailed</tt> and <tt class="tag-attribute">status-only</tt> simplifies things
even further.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/docs/basic-auth</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">get</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">detailed</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">status-only</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-10.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">response</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">status</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">401</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Date</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Wed, 14 Apr 2010 12:15:59 GMT</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Server</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Apache</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">WWW-Authenticate</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Basic realm=<tt class="tag-numcharref">&amp;#34;</tt>TestAuthentication<tt class="tag-numcharref">&amp;#34;</tt></span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Vary</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Accept-Encoding</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Content-Length</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">520</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Content-Type</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">text/html; charset=iso-8859-1</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">response</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Finally, let's send the correct <tt class="tag-attribute">username</tt> and
<tt class="tag-attribute">password</tt> so that we can actually get the resource!</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/docs/basic-auth</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">get</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">detailed</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">auth-method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Basic</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">username</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">testuser</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">password</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">testpassword</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-11.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">response</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">status</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">200</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Date</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Wed, 14 Apr 2010 12:16:14 GMT</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Server</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Apache</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Accept-Ranges</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">bytes</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Vary</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Accept-Encoding</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Content-Length</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">174</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Content-Type</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">text/html; charset=utf-8</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="pcdata"> </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">text/html; charset=<tt class="tag-numcharref">&amp;#34;</tt>utf-8<tt class="tag-numcharref">&amp;#34;</tt></span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>html xmlns='http://www.w3.org/1999/xhtml'<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>head<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>title<tt class="tag-genentity">&amp;gt;</tt>Basic authentication test<tt class="tag-genentity">&amp;lt;</tt>/title<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/head<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>body<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>h1<tt class="tag-genentity">&amp;gt;</tt>Basic authentication test<tt class="tag-genentity">&amp;lt;</tt>/h1<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>Success!<tt class="tag-genentity">&amp;lt;</tt>/p<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/body<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/html<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">response</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>If you run the preceding example with some sort of “web sniffer”
enabled, you'll see that the XProc processor and the server perform a little
dance:</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p>XProc requests the page,</p></li><li><p>the web server declines, asserting authentication is required</p></li><li><p>XProc tries again, sending the credentials</p></li><li><p>the web server sends back the representation.</p></li></ol></div><p>By adding <tt class="code"><tt class="tag-attribute">send-authorization</tt>="<tt class="literal">true</tt>"</tt>,
you can reduce the dance by two steps: the XProc processor will send the
credentials initially and the web server will respond with the representation.
</p><p>This only works for basic authentication. If you use basic
authentication you really <em>should</em> use <tt class="uri">https:</tt> as passwords are otherwise sent
unencrypted, visible to anyone with the aforementioned “web
sniffer”.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/docs/basic-auth</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">get</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">detailed</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">auth-method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Basic</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">username</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">testuser</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">password</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">testpassword</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">send-authorization</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-12.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">response</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">status</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">200</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Date</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Wed, 14 Apr 2010 12:16:19 GMT</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Server</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Apache</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Accept-Ranges</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">bytes</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Vary</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Accept-Encoding</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Content-Length</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">174</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Content-Type</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">text/html; charset=utf-8</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="pcdata"> </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">text/html; charset=<tt class="tag-numcharref">&amp;#34;</tt>utf-8<tt class="tag-numcharref">&amp;#34;</tt></span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>html xmlns='http://www.w3.org/1999/xhtml'<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>head<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>title<tt class="tag-genentity">&amp;gt;</tt>Basic authentication test<tt class="tag-genentity">&amp;lt;</tt>/title<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/head<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>body<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>h1<tt class="tag-genentity">&amp;gt;</tt>Basic authentication test<tt class="tag-genentity">&amp;lt;</tt>/h1<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>Success!<tt class="tag-genentity">&amp;lt;</tt>/p<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/body<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>/html<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">response</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>The <tt class="tag-attribute">detailed</tt> and <tt class="tag-attribute">status-only</tt> attributes aren't
just for authentication. You can use them for unprotected resources as well.
Here's an example that uses <tt class="tag-attribute">detailed</tt> on an ordinary resource.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/docs/helloworld.xml</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">get</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">detailed</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-13.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">response</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">status</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">200</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Date</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Wed, 14 Apr 2010 12:16:24 GMT</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Server</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Apache</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Last-Modified</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Wed, 03 Mar 2010 22:02:44 GMT</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ETag</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue"><tt class="tag-numcharref">&amp;#34;</tt>559da1a-ce-480eca44d2900<tt class="tag-numcharref">&amp;#34;</tt></span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Accept-Ranges</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">bytes</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Content-Length</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">206</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">header</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Content-Type</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">application/xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="pcdata"> </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">application/xml</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Hello world!</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">h1</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-localname">img</tt><span class="pcdata"> </span><tt class="tag-attribute">src</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">helloworld.png</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">alt</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Hello World!</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-localname">h1</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">This is a hello world document.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 25</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">response</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Without <tt class="code"><tt class="tag-attribute">detailed</tt>="<tt class="literal">true</tt>"</tt>,
you just get back the resource:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://tests.xproc.org/docs/helloworld.xml</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">get</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">http-request</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/http-request-14.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Hello world!</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">h1</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">img</tt><span class="pcdata"> </span><tt class="tag-attribute">src</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">helloworld.png</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">alt</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">Hello World!</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">h1</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">This is a hello world document.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Just like the first example!</p>

</div></div><div class="refentry" id="p.identity"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:identity</tt></span></h2><p><span class="refname"><tt class="step">p:identity</tt></span> — Passes its input through unchanged.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:identity</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="code">p:identity</tt> step makes a verbatim copy of its
input available on its output. By itself, this may not seem very useful,
but it is, at least in two common situations.</p>

<p>The first is when you want to extract some portion of a document flowing
through a pipeline. Using a <tt class="tag-attribute">select</tt> attribute on the input to
<tt class="step">p:identity</tt> extracts those parts and copies them through
unchanged.</p>

<p>The second is in <tt class="step">p:choose</tt> steps, where you may want
one or more of the branches of the choice to “do nothing”.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>In the simplest case, <tt class="step">p:identity</tt> just passes
its input to the result port.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/identity-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Hello world.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Hello world.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>A common use of <tt class="step">p:identity</tt> is to extract some
portion or portions of a document.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/doc/div</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/identity-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Hello world!</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Work.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Sleep.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Eat.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Play.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Goodbye, cruel world.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Hello world!</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Work.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Sleep.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Eat.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Play.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Goodbye, cruel world.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Another common use is in one of the branches of a
<tt class="step">p:choose</tt>.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:db</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://docbook.org/ns/docbook</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">choose</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">when</tt><span class="pcdata"> </span><tt class="tag-attribute">test</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/db:*</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">xslt</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">stylesheet</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">document</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">docbook.xsl</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">xslt</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">when</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">otherwise</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">otherwise</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">choose</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/identity-3.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:db</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://docbook.org/ns/docbook</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Hello world!</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:db</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://docbook.org/ns/docbook</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Hello world!</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.insert"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:insert</tt></span></h2><p><span class="refname"><tt class="step">p:insert</tt></span> — Inserts content into a document.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:insert</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">insertion</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'/*'</code><code>"</code><code>/&gt;</code><code>                        </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">position</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                   </code><code class="comment">&lt;!-- </code><span class="opt-type">"first-child" | "last-child" | "before" | "after"</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:insert</tt> step inserts content into a document at the
positions identified by the <tt class="option">match</tt> pattern.</p>

<p>Multiple matches are
allowed, in which case multiple copies of the <tt class="port">insertion</tt>
documents will occur. If no elements match, then the document is
unchanged.</p>

<p>The value of the <tt class="option">position</tt> option
determines how the insertionis performed:</p>

<div class="variablelist"><dl><dt id="p.insert.3.5.1.1"><tt class="literal">first-child</tt></dt><dd><p>The insertion is made as the first child of the matched element.
</p></dd><dt id="p.insert.3.5.2.1"><tt class="literal">last-child</tt></dt><dd><p>The insertion is made as the last child of the matched element.
</p></dd><dt id="p.insert.3.5.3.1"><tt class="literal">before</tt></dt><dd><p>The insertion is made before the matched node.
</p></dd><dt id="p.insert.3.5.4.1"><tt class="literal">after</tt></dt><dd><p>The insertion is made after the matched node.
</p></dd></dl></div>

<p>In the case of <tt class="literal">first-child</tt> and <tt class="literal">last-child</tt>,
it is an error if the matched node is not an element (because the other kinds
of nodes don't have children).</p>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0023.1"/><code>err:C0023</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the pattern matches
anything other than element, text, processing-instruction, or comment nodes.
</td></tr><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0025"/><code>err:C0025</code></td><td style="">Occurs
if the match pattern matches anything other than an element node and
the value of the <tt class="option">position</tt> option is
“<tt class="literal">first-child</tt>” or
“<tt class="literal">last-child</tt>”.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>The <tt class="step">p:insert</tt> step inserts one document into
another. You select where and at what position to make the insertion,
before the matched location:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">insert</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/doc/div</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">position</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">before</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">insertion</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Hello world.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">insert</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/insert-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Play.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Hello world.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Play.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>After the matched location:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">insert</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/doc/div</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">position</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">after</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">insertion</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Goodbye, cruel world.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">insert</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/insert-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Play.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Play.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Goodbye, cruel world.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>As the first child:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">insert</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/doc/div</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">position</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">first-child</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">insertion</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Work.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Sleep.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Eat.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">insert</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/insert-3.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Play.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Work.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Sleep.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Eat.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Play.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Or as the last child:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">insert</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/doc/div</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">position</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">last-child</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">insertion</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Work.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Sleep.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Eat.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">insert</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/insert-4.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Play.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Play.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Work.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Sleep.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Eat.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.label-elements"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:label-elements</tt></span></h2><p><span class="refname"><tt class="step">p:label-elements</tt></span> — Adds an attribute (often <tt class="tag-attribute">xml:id</tt>) to matching elements.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:label-elements</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">attribute</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'xml:id'</code><code>"</code><code>/&gt;</code><code>                </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">attribute-prefix</code><code>"</code><code>/&gt;</code><code>                           </code><code class="comment">&lt;!-- </code><span class="opt-type">NCName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">attribute-namespace</code><code>"</code><code>/&gt;</code><code>                        </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">label</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'concat("_",$p:index)'</code><code>"</code><code>/&gt;</code><code>      </code><code class="comment">&lt;!-- </code><span class="opt-type">XPathExpression</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'*'</code><code>"</code><code>/&gt;</code><code>                         </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">replace</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>                    </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="code">p:label-elements</tt> step generates a label for
each matched element and stores that label in the specified
attribute.</p>

<p>On each element that matches the specified <tt class="option">match</tt>
option, the value of the <tt class="option">label</tt> option is interpreted
as an XPath expression and evaluated with the context node set to the
matched element. The string value of the result of that evaluation is the
label.</p>

<p>The name of the attribute is computed from the <tt class="option">attribute</tt>,
<tt class="option">attribute-prefix</tt> and <tt class="option">attribute-namespace</tt>
options.</p>

<p>An attribute with that name is added to the element using the label
as its value. If the <tt class="option">replace</tt> option is “<tt class="literal">true</tt>”,
then any existing attribute with that name will be replaced, otherwise
the existing attribute is left unchanged.</p>

<p>The XPath expression in the <tt class="option">label</tt> option may refer
to a special variable, <tt class="varname">p:index</tt>. The value of
<tt class="varname">p:index</tt> is an integer, incremented for each matching
element. On the first match, it will have the value “1”, on the second,
“2”, etc.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.D0034.2"/><code>err:D0034</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the lexical value of the specified name contains a
colon and either the <tt class="option">attribute-prefix</tt> or
<tt class="option">attribute-namespace</tt> options are specified.
</td></tr><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0023.2"/><code>err:C0023</code></td><td style="">Occurs
if the <tt class="option">match</tt> pattern expression matches
anything other than an element node.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>The <tt class="step">p:label-elements</tt> step is most often used
to add <tt class="tag-attribute">xml:id</tt> attributes (or ID attributes with some other
name) to elements. By default, it does this for all elements, replacing
any existing values:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">label-elements</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/label-elements-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">One</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">second</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Two</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Three</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">_1</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">_2</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">One</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">_3</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Two</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">_4</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Three</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>You can be more selective by changing <tt class="option">match</tt>
and other options.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">label-elements</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">p</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">replace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">false</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">                    </span><tt class="tag-attribute">label</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">concat(<tt class="tag-numcharref">&amp;#34;</tt>ID-<tt class="tag-numcharref">&amp;#34;</tt>,$p:index)</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/label-elements-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">One</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">second</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Two</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Three</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ID-1</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">One</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">second</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Two</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">ID-2</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Three</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.load"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:load</tt></span></h2><p><span class="refname"><tt class="step">p:load</tt></span> — Loads a document from a URI.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:load</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">href</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                       </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">dtd-validate</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>              </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:load</tt> step loads the document specified in the
<tt class="option">href</tt> option. The <tt class="step">p:load</tt> step is the same
as <tt class="tag-element">p:document</tt> except that the URI can be computed dynamically
and DTD validation can be requested:</p>

<p>When <tt class="option">dtd-validate</tt> is <tt class="literal">true</tt>,
the processor uses a validating parser. A validating parser performs DTD
validation; if you want to perform RELAX NG or XML Schema validation, use
the <tt class="step">p:validate-with-relax-ng</tt> or <tt class="step">p:validate-with-xml-schema</tt>
steps, respectively.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0027"/><code>err:C0027</code></td><td style="">Occurs
if the
document is not valid or the step doesn't support DTD
validation.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>In this example, we load a document specified in an option.
    </p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">href</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'../docs/document.xml'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">load</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">with-option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">href</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">$href</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">load</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/load-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">document</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">This is a paragraph of text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">So is this</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">document</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>This time we'll load a document that includes a DTD.</p><div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;!DOCTYPE doc [
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!ELEMENT doc (p+)&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!ELEMENT p (#PCDATA)*&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>]&gt;
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>&lt;doc&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;p&gt;I'm valid!&lt;/p&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/doc&gt;
</pre></div><p>This document is valid.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">href</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'../docs/valid.xml'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">load</tt><span class="pcdata"> </span><tt class="tag-attribute">dtd-validate</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">with-option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">href</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">$href</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">load</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/load-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">I'm valid!</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>As we've seen in other examples, <tt class="step">p:try</tt>/<tt class="step">p:catch</tt>
can be used to recover from dynamic errors. In this example, we attempt to
load a valid document. If the document isn't valid, we load it anyway, but add
an attribute to the root element (so that subsequent pipeline processing
can tell, presumably).</p><p>This document also includes a DTD:</p><div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;!DOCTYPE doc [
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!ELEMENT doc (p+)&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!ELEMENT p (#PCDATA)*&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>]&gt;
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>&lt;doc&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;para&gt;I'm not valid!&lt;/para&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/doc&gt;
</pre></div><p>But it is not valid. (a <tt class="tag-element">para</tt> appears where a
<tt class="tag-element">p</tt> is expected.)</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">href</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'../docs/invalid.xml'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">try</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">group</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">load</tt><span class="pcdata"> </span><tt class="tag-attribute">dtd-validate</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">with-option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">href</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">$href</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">load</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">group</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">catch</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">load</tt><span class="pcdata"> </span><tt class="tag-attribute">dtd-validate</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">false</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">with-option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">href</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">$href</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">load</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">add-attribute</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/*</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">attribute-name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">INVALID</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                       </span><tt class="tag-attribute">attribute-value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">document-failed-dtd-validation</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">catch</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">try</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/load-3.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="pcdata"> </span><tt class="tag-attribute">INVALID</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">document-failed-dtd-validation</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">I'm not valid!</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.make-absolute-uris"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:make-absolute-uris</tt></span></h2><p><span class="refname"><tt class="step">p:make-absolute-uris</tt></span> — Resolves relative URIs to absolute URIs in the source document.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:make-absolute-uris</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">base-uri</code><code>"</code><code>/&gt;</code><code>                                   </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="code">p:make-absolute-uris</tt> expands relative URIs in the
matched node into absolute URIs. If an explicit <tt class="option">base-uri</tt> is
specified, then the relative URIs are made absolute against that base, otherwise
they are made absolute relative to the base URI in scope where they occur.
</p>

<p>The value of the <tt class="option">base-uri</tt> is interpreted
as an IRI reference. If the <em>option value</em> is relative,
it is made absolute with respect to the in-scope base URI where the option
occurs.</p>

<p>If the IRI reference specified by the
<tt class="option">base-uri</tt> option on <tt class="tag-element">p:make-absolute-uris</tt> is
not valid, or if it is absent and the input document has no base URI,
the results are
<em class="glossterm">implementation-dependent</em>.
</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0023.3"/><code>err:C0023</code></td><td style="">Occurs
if
the pattern matches anything other than element or attribute
nodes.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>In the following example, the <tt class="tag-attribute">href</tt> attribute is
made absolute:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">make-absolute-uris</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">@href</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/make-absolute-uris-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">link</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">../test.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://example.com/path/</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">link</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">relative.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">link</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/test.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://example.com/path/</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">link</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://example.com/path/relative.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>In this example, we specify an explicit base URI.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">make-absolute-uris</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">@href</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">                        </span><tt class="tag-attribute">base-uri</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:///absolute/path/</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/make-absolute-uris-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">link</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">../test.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://example.com/path/</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">link</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">relative.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">link</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/absolute/test.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:base</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://example.com/path/</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">link</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/absolute/path/relative.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.namespace-rename"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:namespace-rename</tt></span></h2><p><span class="refname"><tt class="step">p:namespace-rename</tt></span> — Changes the URI associated with a namespace binding.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:namespace-rename</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">from</code><code>"</code><code>/&gt;</code><code>                                       </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">to</code><code>"</code><code>/&gt;</code><code>                                         </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">apply-to</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'all'</code><code>"</code><code>/&gt;</code><code>                    </code><code class="comment">&lt;!-- </code><span class="opt-type">"all" | "elements" | "attributes"</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>In the serialized form of an XML document, changing the URI
associated with a namespace declaration is a small, local operation.
In an XPath data model, changing the URI associated with a namespace
binding effects not just the element on which the changes is made, but
potentially all of it's descendants.</p>

<p>The <tt class="step">p:namespace-rename</tt> step exists to accomplish this
task. It changes the URI associated with a namespace binding for an entire
substree of the document.
This renaming can be applied to elements, attributes, or both elements
and attribute, as controlled by the <tt class="option">apply-to</tt> option.
</p>

<p>This step <em>cannot</em> perform operations that are
forbidden by XML. You cannot change the XML namespace
(<tt class="uri">http://www.w3.org/XML/1998/namespace</tt>)
or the XMLNS namespace (<tt class="uri">http://www.w3.org/2000/xmlns/</tt>).</p>

<p>If the value of the <tt class="option">from</tt> option is the same as
the value of the <tt class="option">to</tt> option, the input is reproduced
unchanged on the output. Otherwise, namespace bindings, namespace
attributes and element and attribute names are changed as
follows:</p>

<p>FIXME:</p>



<p>The <tt class="option">apply-to</tt> option is primarily intended to make
it possible to avoid renaming attributes when the <tt class="option">from</tt> option
specifies no namespace, since many attributes are in no namespace.</p>

<p>Care should be taken when specifying no namespace with the
<tt class="option">to</tt> option.  Prefixed names in content, for example QNames and
XPath expressions, may end up with no appropriate namespace binding.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0014"/><code>err:C0014</code></td><td style="">Occurs
if the XML namespace (<tt class="uri">http://www.w3.org/XML/1998/namespace</tt>)
or the XMLNS namespace (<tt class="uri">http://www.w3.org/2000/xmlns/</tt>) is
the value of either the <tt class="option">from</tt> option or the
<tt class="option">to</tt> option.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>One use of <tt class="step">p:namepace-rename</tt> is to move content that
is (or isn't) in a namespace into (or out of) a namespace.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">namespace-rename</tt><span class="pcdata"> </span><tt class="tag-attribute">from</tt><span class="atteq">=</span><span class="attq">"</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">                      </span><tt class="tag-attribute">to</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/namespace-rename-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">My Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Hello world.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">My Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Hello world.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>It can also be used to change the namespace associated with
attributes.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">namespace-rename</tt><span class="pcdata"> </span><tt class="tag-attribute">from</tt><span class="atteq">=</span><span class="attq">"</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">                      </span><tt class="tag-attribute">to</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xlink</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                      </span><tt class="tag-attribute">apply-to</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">attributes</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/namespace-rename-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-element">para</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:_1</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xlink</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">        </span><tt class="tag-element">_1:href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.pack"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:pack</tt></span></h2><p><span class="refname"><tt class="step">p:pack</tt></span> — Merges two document sequences.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:pack</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">alternate</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">wrapper</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                    </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">wrapper-prefix</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">NCName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">wrapper-namespace</code><code>"</code><code>/&gt;</code><code>                          </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="code">p:pack</tt> step merges two document sequences, “packing”
their members together. One document is read from each sequence and each
pair is placed in the specified wrapper. The result is a sequence of
documents containing such pairs.</p>

<p>If the step reaches the end of one input sequence before the
other, then it simply wraps each of the remaining documents in the
longer sequence.</p>

<div class="note admonition"><h3>Note</h3><p>In the common case, where the document element of a document in
the <tt class="port">result</tt> sequence has two element children, any
comments, processing instructions, or white space text nodes that
occur between them may have come from either of the input documents;
this step does not attempt to distinguish which one.</p></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.D0034.3"/><code>err:D0034</code></td><td style="">Occurs
if you specify a new namespace or prefix when the lexical value of the specified
name contains a colon.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>Steps in XProc read either a single document (and specifying
multiple documents is an error) or they read <em>all</em>
the documents sent to them. The <tt class="step">p:pack</tt> step makes it possible
to group documents from two input streams, allowing you to effectively
read one document at a time.</p><p>This example uses <tt class="step">p:pack</tt> to transform a
4x<em class="replaceable"><tt class="replaceable">n</tt></em> table into an <em class="replaceable"><tt class="replaceable">n</tt></em>x4
table.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">viewport</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">table</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">rotate</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">col1</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/table/tr[1]/td</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">rotate</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">current</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">col2</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/table/tr[2]/td</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">rotate</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">current</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">col3</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/table/tr[3]/td</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">rotate</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">current</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">col4</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/table/tr[4]/td</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">rotate</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">current</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 25</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pack</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">c12</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">wrap12</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">col1</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">alternate</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 30</span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">col2</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pack</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pack</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">c34</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">wrap34</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 35</span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">col3</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">alternate</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">col4</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 40</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pack</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pack</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">c1234</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">wrapper</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">c12</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 45</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">alternate</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">c34</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pack</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">for-each</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 50</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">for-each</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">iteration-source</tt><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">//td</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">for-each</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap-sequence</tt><span class="pcdata"> </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">tr</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 55</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">for-each</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap-sequence</tt><span class="pcdata"> </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">table</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">viewport</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/pack-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">This is a table.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">table</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">A1</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">B1</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">C1</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">A2</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">B2</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">C2</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">A3</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">B3</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">C3</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">A4</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">B4</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">C4</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">table</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 25</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">This is a table.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">table</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">A1</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">B1</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">C1</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">A2</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">A3</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">A4</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">B1</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">B2</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">B3</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">B4</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">C1</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">C2</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">C3</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span><span class="pcdata">C4</span><span class="mso">&lt;/</span><tt class="tag-localname">td</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">tr</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">table</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.parameters"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:parameters</tt></span></h2><p><span class="refname"><tt class="step">p:parameters</tt></span> — Converts step parameters into XML.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:parameters</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">parameters</code><code>"</code> <code class="attr kind-attr">kind</code><code>="</code><code class="value kind-value">parameter</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">false</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">false</code><code>"</code><code>/&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="code">p:parameters</tt> step accepts any number of parameters
and delivers them back in a <tt class="tag-element">c:param-set</tt> document.</p>

<p>Each parameter passed to the step is converted into a
<tt class="tag-element">c:param</tt> element. The step resolves duplicate parameters in
the normal way (see <span class="formatting-error">???</span>) so at most one
parameter with any given name will appear in the result.
The resulting <tt class="tag-element">c:param</tt> elements are wrapped in a
<tt class="tag-element">c:param-set</tt> and the parameter set document is written
to the <tt class="port">result</tt> port.
</p>

<p>The <tt class="step">p:parameters</tt> step always uses the
<tt class="tag-attribute">namespace</tt> attribute on <tt class="tag-element">c:param</tt> if the parameter
is in a namespace. In other words, the <tt class="tag-attribute">name</tt> on the
<tt class="tag-element">c:param</tt> will never contain a colon.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>Pipelines can't directly access parameters by name (because the
names of parameters aren't known in advance). To find out what parameters
were passed to the pipeline, the <tt class="step">p:parameters</tt> step is first
used to create a document, then that document can be interrogated with
XPath.</p><p>This pipeline just prints the parameters passed to it (in this case,
<tt class="literal">param</tt> with the value “<tt class="literal">value</tt>” and
<tt class="literal">cx:test</tt> with the value “<tt class="literal">othervalue</tt>”).</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">main</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">parameters</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">params</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">parameters</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">main</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">parameters</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">parameters</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">params</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/parameters-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">param-set</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">param</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">param</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">value</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">param</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">test</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">           </span><tt class="tag-attribute">namespace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://xmlcalabash.com/ns/extensions</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">           </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">othervalue</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">param-set</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>
    
      
      
    
  <p>Note that neither the <tt class="port">parameters</tt> port nor the
    <tt class="port">result</tt> output on <tt class="step">p:parameters</tt> are
    primary, so we must connect to them explicitly.</p>

</div></div><div class="refentry" id="p.rename"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:rename</tt></span></h2><p><span class="refname"><tt class="step">p:rename</tt></span> — Renames elements, attributes, or processing instructions.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:rename</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">new-name</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                   </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">new-prefix</code><code>"</code><code>/&gt;</code><code>                                 </code><code class="comment">&lt;!-- </code><span class="opt-type">NCName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">new-namespace</code><code>"</code><code>/&gt;</code><code>                              </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="code">p:rename</tt> step renames matching elements,
attributes, or processing-instructions in the document. It doesn't
make any sense to match comment or text nodes, they don't have
names.</p>

<p>If the <tt class="option">new-name</tt> value contains a colon, then
its value is interpreted as a QName and there must be an in-scope namespace
declaration for that prefix in the pipeline document. It is an error in this
case to specify either an <tt class="option">new-prefix</tt> or
<tt class="option">new-namespace</tt>.</p>

<p>If the <tt class="option">new-name</tt> option does not contain a
colon, you can use the <tt class="option">new-namespace</tt> and
<tt class="option">new-prefix</tt> options to place it in a namespace and
provide a suggested prefix.</p>

<p>Each element, attribute, or processing-instruction that matches
the <tt class="option">match</tt> option is renamed with the specified name.
In the case of attributes, if the element already had an attribute with
the specified name, it is effectively deleted before the renaming is
performed.
</p>

<p>With respect to attributes named “<tt class="literal">xml:base</tt>”,
the following semantics apply: renaming an <em>from</em>
“<tt class="literal">xml:base</tt>” <em>to</em> something else
has no effect on the underlying base URI of the element; however, if
an attribute is renamed <em>from</em> something else
<em>to</em> “<tt class="literal">xml:base</tt>”, the base URI of
the element is updated accordingly.</p>

<p>If the pattern matches processing instructions, then it is the
processing instruction target that is renamed. In this case, it's an error
if the new name specifies a namespace.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0023.4"/><code>err:C0023</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the pattern matches anything other than element,
attribute or processing instruction nodes.
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.D0034.4"/><code>err:D0034</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
It is a
<em class="glossterm">dynamic error</em> to specify a new namespace or
prefix if the lexical value of the specified name contains a
colon.
</td></tr><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0013"/><code>err:C0013</code></td><td style="">Occurs
if the pattern matches
a processing instruction and the new name has a non-null namespace.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This pipeline renames the <tt class="tag-element">para</tt> elements to
<tt class="tag-element">p</tt>:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">rename</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">para</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">new-name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">h:p</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/rename-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;?</span><span class="pitarget">vocabulary</span><span class="pidata"> pseudo-docbook</span><span class="msc">?&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-element">para</tt><span> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">summary</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-element">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-element">para</tt><span class="msc">&gt;</span><span class="pcdata">Some other text.</span><span class="mso">&lt;/</span><tt class="tag-element">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;?</span><span class="pitarget">vocabulary</span><span class="pidata"> pseudo-docbook</span><span class="msc">?&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-element">h</tt><span>:</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">summary</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-element">h</tt><span class="colon">:</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-element">h</tt><span class="colon">:</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span><span class="pcdata">Some other text.</span><span class="mso">&lt;/</span><tt class="tag-element">h</tt><span class="colon">:</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>This pipeline renames the <tt class="tag-attribute">role</tt> attribute to
<tt class="tag-attribute">class</tt>:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">rename</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">@role</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">new-name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">class</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/rename-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;?</span><span class="pitarget">vocabulary</span><span class="pidata"> pseudo-docbook</span><span class="msc">?&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">summary</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some other text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;?</span><span class="pitarget">vocabulary</span><span class="pidata"> pseudo-docbook</span><span class="msc">?&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">summary</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some other text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>This pipeline renames the processing instruction:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">rename</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">processing-instruction('vocabulary')</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">new-name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">old-vocabulary</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/rename-3.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;?</span><span class="pitarget">vocabulary</span><span class="pidata"> pseudo-docbook</span><span class="msc">?&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">summary</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some other text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;?</span><span class="pitarget">old-vocabulary</span><span class="pidata"> pseudo-docbook</span><span class="msc">?&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">summary</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some other text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.replace"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:replace</tt></span></h2><p><span class="refname"><tt class="step">p:replace</tt></span> — Replaces matching content.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:replace</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">replacement</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="code">p:replace</tt> step replaces matching nodes in its input
with the content of the <tt class="port">replacement</tt> document.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0023.5"/><code>err:C0023</code></td><td style="">Occurs
if the <tt class="option">match</tt> pattern matches
anything other than element, text, processing-instruction, or comment
nodes.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This pipeline replaces the paragraph with the “<tt class="literal">summary</tt>”
role with a new paragraph.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match="para[@role</tt><span class="atteq">=</span><span class="attq">'</span><span class="attvalue">summary</span><span class="attq">'</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">replacement</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Static text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">replace</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/replace-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">summary</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some other text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Static text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some other text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>The preceding example isn't very practical because the replacement
text is static. For a more realistic example, consider this pipeline which
uses XSLT to update the summary paragraph, then uses <tt class="step">p:replace</tt>
to replace the original with the new version.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">main</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">xslt</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select="//para[@role</tt><span class="atteq">=</span><span class="attq">'</span><span class="attvalue">summary</span><span class="attq">'</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">stylesheet</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">stylesheet</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:xsl</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/XSL/Transform</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                        </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">2.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">template</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">para</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">copy</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">copy-of</tt><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">@*</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">text</tt><span class="msc">&gt;</span><span class="pcdata">In summary: </span><span class="mso">&lt;/</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">text</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">apply-templates</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;/</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">copy</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">template</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">stylesheet</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">xslt</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match="para[@role</tt><span class="atteq">=</span><span class="attq">'</span><span class="attvalue">summary</span><span class="attq">'</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">main</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 25</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">replace</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/replace-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">summary</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some other text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">summary</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">In summary: Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Some other text.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>(Though a <tt class="step">p:viewport</tt> would make more sense here.)</p>

</div></div><div class="refentry" id="p.set-attributes"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:set-attributes</tt></span></h2><p><span class="refname"><tt class="step">p:set-attributes</tt></span> — Sets a number of attributes at once.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:set-attributes</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">attributes</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:set-attributes</tt> step is a shortcut for several
consecutive <tt class="step">p:add-attribute</tt> steps. Instead of taking the
attributes as options, it takes a second document. All of the
attributes on the document element of that document are copied onto
matching elements in the source document.</p>

<p>If an attribute with the same name as one of the attributes to
be copied already exists, the value specified on the
<tt class="port">attribute</tt> port's document is used.</p>

<p>If an attribute named <tt class="tag-attribute">xml:base</tt> is
added or changed, the base URI of the element is amended
accordingly.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0023.6"/><code>err:C0023</code></td><td style="">Occurs
if the <tt class="option">match</tt> pattern matches anything other than
element nodes.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This pipeline adds both <tt class="tag-attribute">role</tt> and <tt class="tag-attribute">version</tt>
attributes to any matching section.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">set-attributes</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">section[not(@role)]</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">attributes</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">irrelevant-element-name</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">new-role</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                                 </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">new-version</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">set-attributes</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/set-attributes-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">section</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">introduction</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">section content</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">section</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">section</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">other section content</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">section</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">section</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">introduction</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">section content</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">section</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">section</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">new-role</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">new-version</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">other section content</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">section</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>The <tt class="tag-element">p:set-attributes</tt> step replaces attributes if
    they already exist:</p><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">section</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">introduction</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">old-version</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">section content</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">section</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">section</tt><span class="pcdata"> </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">old-version</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">other section content</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">section</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">section</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">introduction</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">old-version</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">section content</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">section</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">section</tt><span class="pcdata"> </span><tt class="tag-attribute">role</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">new-role</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">new-version</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">other section content</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">section</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>
</div></div><div class="refentry" id="p.sink"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:sink</tt></span></h2><p><span class="refname"><tt class="step">p:sink</tt></span> — Discards its input.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:sink</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:sink</tt> step accepts a sequence of documents and
discards them. It has no output.</p>

<p>This is valuable when you want to ignore the primary output of some
step (perhaps because you only care about one of its secondary outputs or
you are relying on some side-effect that it has).</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>There's nothing much to show, really, <tt class="step">p:sink</tt> is just
a bit bucket. In this example, we explicitly discard the primary output of
the <tt class="step">p:xslt</tt> step and return only the content of its secondary
output.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">xslt</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">style</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">stylesheet</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">stylesheet</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:xsl</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/XSL/Transform</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                        </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">2.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">template</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">sequence</tt><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">.</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">result-document</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://example.com/foo</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Secondary result document.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;/</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">result-document</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">template</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">xsl</tt><span class="colon">:</span><tt class="tag-localname">stylesheet</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">xslt</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">sink</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 25</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">style</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">secondary</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/sink-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Hello world.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Secondary result document.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Without the <tt class="step">p:sink</tt>, the XProc processor would have
complained about the unbound primary output port on the <tt class="step">p:xslt</tt>
step.</p>

</div></div><div class="refentry" id="p.split-sequence"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:split-sequence</tt></span></h2><p><span class="refname"><tt class="step">p:split-sequence</tt></span> — Divides a sequence of documents into two sequences.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:split-sequence</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">matched</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">not-matched</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">initial-only</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>              </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">test</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                       </code><code class="comment">&lt;!-- </code><span class="opt-type">XPathExpression</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:split-sequence</tt> step accepts a sequence of
documents and divides it into two sequences. For each input document,
the <tt class="option">test</tt> expression is evaluated using that document
as the context node. If the effective boolean value of the expression
is “<tt class="literal">true</tt>”, then the document is passed to the
<tt class="port">matched</tt> port, otherwise it is passed to the
<tt class="port">not-matched</tt> port.</p>

<p>If the <tt class="option">initial-only</tt> option is true, then when
the first document that does not satisfy the test expression is
encountered, it <em>and all the documents that follow
it</em> are written to the <tt class="port">not-matched</tt> port.
In other words, it only writes the initial series of matched
documents (which may be empty) to the <tt class="port">matched</tt> port.
All other documents are written to the <tt class="port">not-matched</tt> port,
irrespective of whether or not they match.</p>

<p>When evaluating the test, the context position
(<tt class="code">position()</tt>) is the position of that document within the
sequence and the context size (<tt class="code">last()</tt>) is the total
number of documents in the sequence.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This pipeline accepts a sequence of documents and counts the number
of DocBook documents in the sequence.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">declare-step</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                </span><span class="nsdecl"><tt class="tag-attribute">xmlns:db</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://docbook.org/ns/docbook</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">sequence</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">output</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">split-sequence</tt><span class="pcdata"> </span><tt class="tag-attribute">test</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/db:*</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">count</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">declare-step</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/split-sequence-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:db</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://docbook.org/ns/docbook</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Hello world.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span><span class="pcdata">0</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>(FIXME: the example doesn't really get a sequence)</p><p>This pipeline accepts a sequence of documents and counts the number
of <em>non-</em>DocBook documents in the sequence.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">declare-step</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                </span><span class="nsdecl"><tt class="tag-attribute">xmlns:db</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://docbook.org/ns/docbook</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">sequence</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">output</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">split-sequence</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">split</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">test</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/db:*</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">sink</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">count</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">split</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">not-matched</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">count</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">declare-step</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/split-sequence-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:db</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://docbook.org/ns/docbook</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">Hello world.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span><span class="pcdata">1</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>(FIXME: the example doesn't really get a sequence)</p>

</div></div><div class="refentry" id="p.store"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:store</tt></span></h2><p><span class="refname"><tt class="step">p:store</tt></span> — Stores a document (usually on the filesystem).</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:store</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">false</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">href</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                       </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">byte-order-mark</code><code>"</code><code>/&gt;</code><code>                            </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">cdata-section-elements</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">''</code><code>"</code><code>/&gt;</code><code>         </code><code class="comment">&lt;!-- </code><span class="opt-type">ListOfQNames</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">doctype-public</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">doctype-system</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">encoding</code><code>"</code><code>/&gt;</code><code>                                   </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">escape-uri-attributes</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>     </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">include-content-type</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>       </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">indent</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>                    </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">media-type</code><code>"</code><code>/&gt;</code><code>                                 </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">method</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'xml'</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">normalization-form</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'none'</code><code>"</code><code>/&gt;</code><code>         </code><code class="comment">&lt;!-- </code><span class="opt-type">NormalizationForm</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">omit-xml-declaration</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>       </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">standalone</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'omit'</code><code>"</code><code>/&gt;</code><code>                 </code><code class="comment">&lt;!-- </code><span class="opt-type">"true" | "false" | "omit"</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">undeclare-prefixes</code><code>"</code><code>/&gt;</code><code>                         </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">version</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'1.0'</code><code>"</code><code>/&gt;</code><code>                     </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:store</tt> step serializes its input document and stores
it at the specified URI.</p>

<p>If the <tt class="option">href</tt> option is relative, it's made
absolute against the base URI of the element on which it is specified
in the pipeline.</p>

<p>The output of this step is a document containing a single
<tt class="tag-element">c:result</tt> element whose content is the absolute URI of the
document stored by the step.</p>

<p>The standard serialization options are provided to control the
serialization of the XML content when it is stored. These options are
as specified in <span class="formatting-error">???</span>.</p>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0050"/><code>err:C0050</code></td><td style="">Occurs
if the URI scheme is not supported or the step cannot store to the
specified location.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>In this example, we store a document to the filesystem.
    </p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">store</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">store</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/tmp/out.xml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">store</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/store-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span><span class="pcdata">file:/tmp/out.xml</span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">result</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.string-replace"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:string-replace</tt></span></h2><p><span class="refname"><tt class="step">p:string-replace</tt></span> — Replaces matched nodes with the result of evaluating an XPath expression.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:string-replace</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">replace</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                    </code><code class="comment">&lt;!-- </code><span class="opt-type">XPathExpression</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:string-replace</tt> step replaces matched nodes
with the result of evaluating an XPath expression. In other words, it
allows you to identify a node (or nodes) in the document, perform a
computation on that node, and then update the document to contain the
result of that computation instead of the original node.</p>

<p>More technically, the <tt class="step">p:string-replace</tt> step
replaces nodes in the document provided on the <tt class="port">source</tt>
port that match the pattern specified in the <tt class="option">match</tt>
option with the string result of evaluating the XPath expression
specified in the <tt class="option">replace</tt> option.</p>

<p>For each node in the document provided on the
<tt class="port">source</tt> port:</p>

<div class="itemizedlist"><ul><li><p>If the match pattern specified in the <tt class="option">match</tt> option
matches the node, then the XPath expression provided in the
<tt class="option">replace</tt> option is evaluated with the matched node
as the context.</p><p>If the node is an attribute node then the string value of the
expression replaces the attribute <em>value</em>, if the
node is any other kind of node, then the string value of the
expression replaces the entire node (not just the content of the
node).</p></li><li><p>If the match pattern does not match the node, then the string replace
operation is performed on each of the node's attributes (if it is an element)
and its children. The resulting, transformed node is copied to the output.
</p></li></ul></div>

<p>One of the least convenient parts of the
<tt class="step">p:string-replace</tt> step is the <tt class="option">replace</tt>
option. What you must always bear in mind is that the value of the
<tt class="option">replace</tt> option is treated as an XPath expression
<em>by the step</em>.</p>

<p>Often, this is what you want. Unfortunately, in one of the most
common cases, where you'd like to replace an attribute value with some
computed value, the obvious approach does not do what you'd
expect.</p>

<p>Consider this pipeline:</p>

<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
<span class="linenumber">   </span><span class="linenumber-separator"> </span>                name="main" version="1.0"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;p:output port="result"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>  &lt;p:option name="new-class" select="'new-value'"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;p:string-replace match="p/@class"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:input port="source"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;p:inline&gt;&lt;p class="old-value"&gt;Some text.&lt;/p&gt;&lt;/p:inline&gt;
<span class="linenumber"> 10</span><span class="linenumber-separator"> </span>    &lt;/p:input&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:with-option name="replace" select="$new-class"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;/p:string-replace&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber"> 15</span><span class="linenumber-separator"> </span>&lt;/p:declare-step&gt;
</pre></div>

<p>On the surface, this pipeline appears to replace the value of
the <tt class="tag-attribute">class</tt> attribute with the value passed to the pipeline
in the <tt class="option">new-class</tt> option. The string replace step is
effectively the same as this one:
</p>

<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>  &lt;p:string-replace match="p/@class" replace="new-value"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:input port="source"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;p:inline&gt;&lt;p class="old-value"&gt;Some text.&lt;/p&gt;&lt;/p:inline&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;/p:input&gt;
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>  &lt;/p:string-replace&gt;
</pre></div>

<p>Here we can see that the value of the <tt class="option">replace</tt> option
is a bare name. Recall that <tt class="step">p:string-replace</tt> treats the value
of <tt class="option">replace</tt> <em>as an XPath expression</em>.
A bare name in XPath selects child elements with that name. So, as written,
what this string replace step does is replace the value of the <tt class="tag-attribute">class</tt>
attribute with the string value of its <tt class="tag-element">new-value</tt> element children.</p>

<p>Of course, attributes don't have element children, so the result of
evaluating that XPath expression is always the empty string and that's the
value that will be used for the <tt class="tag-attribute">class</tt> attribute.</p>

<p>The step that we need to evaluate effectively is this one:</p>

<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>  &lt;p:string-replace match="p/@class" replace="'new-value'"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:input port="source"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;p:inline&gt;&lt;p class="old-value"&gt;Some text.&lt;/p&gt;&lt;/p:inline&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;/p:input&gt;
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>  &lt;/p:string-replace&gt;
</pre></div>

<p>That can be achieved in the following way:</p>

<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
<span class="linenumber">   </span><span class="linenumber-separator"> </span>                name="main" version="1.0"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;p:output port="result"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>  &lt;p:option name="new-class" select="'new-value'"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;p:string-replace match="p/@class"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:input port="source"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;p:inline&gt;&lt;p class="old-value"&gt;Some text.&lt;/p&gt;&lt;/p:inline&gt;
<span class="linenumber"> 10</span><span class="linenumber-separator"> </span>    &lt;/p:input&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>    &lt;p:with-option name="replace"
<span class="linenumber">   </span><span class="linenumber-separator"> </span>                   select="concat(&amp;quot;'&amp;quot;,$new-class,&amp;quot;'&amp;quot;)"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>  &lt;/p:string-replace&gt;
<span class="linenumber"> 15</span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/p:declare-step&gt;
</pre></div>

<p>Which is undeniably pretty ugly.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This example updates the class attributes in a document:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">string-replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match="*[@class</tt><span class="atteq">=</span><span class="attq">'</span><span class="attvalue">oldclass</span><span class="attq">'</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">                    </span><tt class="tag-attribute">replace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'newclass'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/string-replace-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">oldclass red</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Red.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">oldclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">otherclass oldclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Something else.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">oldclass red</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Red.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">newclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">otherclass oldclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Something else.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>That misses <tt class="tag-attribute">class</tt> attributes that contain more than
one value. We can improve on that with a slightly more sophisticated
match pattern.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">string-replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">*[contains(@class,'oldclass')]/@class</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">                    </span><tt class="tag-attribute">replace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'newclass'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/string-replace-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">oldclass red</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Red.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">oldclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">otherclass oldclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Something else.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">newclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Red.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">newclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">newclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Something else.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Better, but now we're clobbering the other values. We
can fix that, too.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">string-replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">*[contains(@class,'oldclass')]/@class</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">                    </span><tt class="tag-attribute">replace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">concat(substring-before(.,'oldclass'),'newclass',substring-after(.,'oldclass'))</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/string-replace-3.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">oldclass red</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Red.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">oldclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">otherclass oldclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Something else.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">someoldclasstoo</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Not really old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">newclass red</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Red.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">newclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">otherclass newclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Something else.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">somenewclasstoo</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Not really old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>This is still imperfect as it incorrectly replaces
“<tt class="literal">someoldclasstoo</tt>” with “<tt class="literal">somenewclasstoo</tt>”.
We could improve this further with even more
complex <tt class="option">match</tt> and <tt class="option">replace</tt> options.</p><p>But instead, let's take advantage of the fact that this is a pipeline.
We don't have to do everything all at once.
    </p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">string-replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match="*[@class</tt><span class="atteq">=</span><span class="attq">'</span><span class="attvalue">oldclass</span><span class="attq">'</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">                    </span><tt class="tag-attribute">replace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'newclass'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">string-replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">*[starts-with(@class,'oldclass ')]/@class</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                    </span><tt class="tag-attribute">replace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">concat('newclass ', substring-after(.,'oldclass '))</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">string-replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">*[contains(@class,' oldclass ')]/@class</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                    </span><tt class="tag-attribute">replace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">concat(substring-before(.,' oldclass '),' newclass ',substring-after(.,' oldclass '))</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">string-replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">*[ends-with(@class,' oldclass')]/@class</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                    </span><tt class="tag-attribute">replace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">concat(substring-before(.,' oldclass'), ' newclass')</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/string-replace-4.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">oldclass red</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Red.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">oldclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">otherclass oldclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Something else.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">someoldclasstoo</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Not really old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">newclass red</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Red.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">newclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">otherclass newclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Something else.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">someoldclasstoo</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Not really old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>(This still doesn't handle the case where “<tt class="literal">oldclass</tt>”
appears more than once in the attribute value, but I'm willing to live with
that.)</p><p>It's worth observing that matching on attributes is a special case.
Attribute matches replace the value. Any other kind of match replaces
<em>the entire node</em>. Here we find elements that have the
“<tt class="literal">oldclass</tt>” value and replace them with the new class.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">string-replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match="*[@class</tt><span class="atteq">=</span><span class="attq">'</span><span class="attvalue">oldclass</span><span class="attq">'</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">                    </span><tt class="tag-attribute">replace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'newclass'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/string-replace-5.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span>  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">oldclass red</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Red.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">oldclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Old.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">otherclass oldclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Something else.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="diff"><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span class="diff"><span>&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">oldclass red</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Red.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      newclass</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">otherclass oldclass</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Something else.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.unescape-markup"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:unescape-markup</tt></span></h2><p><span class="refname"><tt class="step">p:unescape-markup</tt></span> — Converts “escaped XML” back into real XML.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:unescape-markup</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">namespace</code><code>"</code><code>/&gt;</code><code>                                  </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">content-type</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'application/xml'</code><code>"</code><code>/&gt;</code><code>    </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">encoding</code><code>"</code><code>/&gt;</code><code>                                   </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">charset</code><code>"</code><code>/&gt;</code><code>                                    </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:unescape-markup</tt> step takes the string value of
the document element and parses the content as if it was a Unicode
character stream containing serialized XML. The output is the result
of that parse inside the same document element wrapper. This
is the reverse of the <tt class="step">p:escape-markup</tt> step.</p>

<p>When the string value is parsed, the original document element
is preserved so that the result will be well-formed XML even if the
content consists of multiple, sibling elements.</p>

<p>The <tt class="option">namespace</tt> option specifies a default
namespace. Elements that are in no namespace in the unescaped content
will be placed into this namespace unless there is an in-scope
namespace declaration that specifies a different namespace (or
explicitly undeclares the default namespace).</p>

<p>The <tt class="option">content-type</tt> option can be used to specify
an alternate content type for the string value. Implementations can
use this value to select different parsing strategies for converting
escaped text into XML. For example, if the value
<tt class="literal">text/html</tt> is used, XML Calabash parses with
<span class="formatting-error">???</span>, which just about guarantees that any
random, sloppy collection of markup will produce well-formed
XML.</p>

<p>If you specify <tt class="literal">application/xml</tt>, all
implementations must use a standard XML parser for it. Behavior of
<tt class="step">p:unescape-markup</tt> for <tt class="option">content-type</tt>s other
than <tt class="literal">application/xml</tt> is
<em class="glossterm">implementation-defined</em>.</p>

<p>The serialized form of an XML document is a sequence of Unicode
characters. If the escaped markup is not in a Unicode-compatible
character set, it may be encoded (so that it can be carried as a
payload in an XML document). In this case the
<tt class="option">encoding</tt> option must be used.</p>

<p>If an <tt class="option">encoding</tt> is specified, a
<tt class="option">charset</tt> may also be specified. The character set may
be specified as a parameter on the <tt class="option">content-type</tt> or
via the separate <tt class="option">charset</tt> option. If the specified
<tt class="option">encoding</tt> is <tt class="literal">base64</tt>, then the
character set must be specified.
</p>

<p>If no <tt class="option">encoding</tt> is specified, the character set
is ignored, irrespective of where it was specified.</p>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0051"/><code>err:C0051</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the content-type specified is not supported by
the implementation.
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0052"/><code>err:C0052</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the
encoding specified is not supported by the
implementation.
</td></tr><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0010"/><code>err:C0010</code></td><td style="">Occurs
if an encoding of <tt class="literal">base64</tt> is specified and
the character set is not specified or if the specified
character set is not supported by the implementation.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This example simply decodes some encoded text:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">unescape-markup</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/unescape-markup-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">description</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  <tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>This is a chunk.<tt class="tag-genentity">&amp;lt;</tt>/p<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  <tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>This is a another chunk.<tt class="tag-genentity">&amp;lt;</tt>/p<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">description</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">description</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">This is a chunk.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">This is a another chunk.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">description</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>The <tt class="option">namespace</tt> option can be used to specify the
default namespace.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">unescape-markup</tt><span class="pcdata"> </span><tt class="tag-attribute">namespace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/unescape-markup-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">description</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  <tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>This is a chunk.<tt class="tag-genentity">&amp;lt;</tt>/p<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  <tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>This is a another chunk.<tt class="tag-genentity">&amp;lt;</tt>/p<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">description</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">description</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span><span class="pcdata">This is a chunk.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span><span class="pcdata">This is a another chunk.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">description</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Simply unescaping the markup in this HTML example would not yield a
well-formed XML result. By specifying a <tt class="literal">text/html</tt>
<tt class="option">content-type</tt>, we give the processor the ability to perform
appropriate “fixup” on the markup.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">unescape-markup</tt><span class="pcdata"> </span><tt class="tag-attribute">content-type</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">text/html</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/unescape-markup-3.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">wrapper</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>html<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>title<tt class="tag-genentity">&amp;gt;</tt>Some title<tt class="tag-genentity">&amp;lt;</tt>/title<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>h1<tt class="tag-genentity">&amp;gt;</tt>Some title<tt class="tag-genentity">&amp;lt;</tt>/h1<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>This is some<tt class="tag-genentity">&amp;lt;</tt>br<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">HTML text</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata"><tt class="tag-genentity">&amp;lt;</tt>p<tt class="tag-genentity">&amp;gt;</tt>It isn't well-formed XML<tt class="tag-genentity">&amp;lt;</tt>br<tt class="tag-genentity">&amp;gt;</tt></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">by any stretch of the imagination</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">wrapper</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">wrapper</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">h1</tt><span class="msc">&gt;</span><span class="pcdata">Some title</span><span class="mso">&lt;/</span><tt class="tag-localname">h1</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">This is some</span><span class="mso">&lt;</span><tt class="tag-localname">br</tt><span class="pcdata"> </span><tt class="tag-attribute">clear</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">none</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">HTML text</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="add"><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">It isn't well-formed XML</span><span class="mso">&lt;</span><tt class="tag-localname">br</tt><span class="pcdata"> </span><tt class="tag-attribute">clear</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">none</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">by any stretch of the imagination</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">wrapper</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.unwrap"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:unwrap</tt></span></h2><p><span class="refname"><tt class="step">p:unwrap</tt></span> — Removes an element, but not its content.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:unwrap</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:unwrap</tt> step replaces an element with its content.
In other words, it deletes the element wrapper but not the children of the
element.</p>

<p>Every element in the input document that matches is replaced by
its children, effectively “unwrapping” the children from their parent.
</p>

<p>This step produces a single document; if the document element is
unwrapped, the result might not be well-formed XML.</p>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0023.7"/><code>err:C0023</code></td><td style="">Occurs
if the <tt class="option">match</tt> pattern matches anything other than element
 nodes.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>In this example, we unwrap <tt class="tag-element">pre</tt> elements from their
containing <tt class="tag-element">div</tt> parents.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">unwrap</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">h:div[h:pre]</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/unwrap-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">add</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">This is new text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">chg</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del strikeout</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some more example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">add</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">This is new text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">chg</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del strikeout</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some more example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Compare these results with <tt class="step">p:delete</tt>.
    </p><p>The <tt class="step">p:unwrap</tt> step uses a
    <em>match</em> pattern which can apply at many different depths
in the document tree. In particular, note that the unwrapped content is also
subject to unwrapping.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">unwrap</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">h:div</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/unwrap-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">add</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">This is new text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">chg</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del strikeout</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some more example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">add</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">This is new text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">chg</span><span class="attq">"</span><span class="msc">&gt;</span><span class="pcdata">Some pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">del strikeout</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some more example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="del"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Using a simple <tt class="option">match</tt> pattern of <tt class="literal">div</tt>
effectively removes <em>every single</em> <tt class="tag-element">div</tt> from
the document.</p>

</div></div><div class="refentry" id="p.uuid"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:uuid</tt></span></h2><p><span class="refname"><tt class="step">p:uuid</tt></span> — Generates a UUID and inserts it into a document.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:uuid</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">version</code><code>"</code><code>/&gt;</code><code>                                    </code><code class="comment">&lt;!-- </code><span class="opt-type">integer</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:uuid</tt> step generates a
<span class="formatting-error">???</span> and injects it into
the input document at the location(s) specified by the
<tt class="option">match</tt> option.
If the <tt class="option">version</tt> is specified, that version of
UUID must be computed.</p>

<p>All implementations support version 4 UUIDs (the random-number based
version).
Support for other versions of UUID, and the mechanism by which
the necessary inputs are made available for computing other versions,
is <em class="glossterm">implementation-defined</em>.
</p>

<p>Each matching node in the source document is replaced by the
UUID (if more than one node matches, the
<em>same</em> UUID value is used as the replacement
each time). If the matched node is an attribute, then the UUID
is used as the new attribute value, in all other cases, the entire node
is replaced.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0060"/><code>err:C0060</code></td><td style="">Occurs
if the processor does not support the specified
<tt class="option">version</tt> of the UUID algorithm.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This example uses a UUID to generate a globally unique identifier.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:rdf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/02/22-rdf-syntax-ns#</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:foaf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://xmlns.com/foaf/0.1/</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">uuid</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/doc/id/text()</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">4</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/uuid-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:rdf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/02/22-rdf-syntax-ns#</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">     </span><span class="nsdecl"><tt class="tag-attribute">xmlns:foaf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://xmlns.com/foaf/0.1/</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">id</tt><span class="msc">&gt;</span><span class="pcdata">@@</span><span class="mso">&lt;/</span><tt class="tag-localname">id</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:rdf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/02/22-rdf-syntax-ns#</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">     </span><span class="nsdecl"><tt class="tag-attribute">xmlns:foaf</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://xmlns.com/foaf/0.1/</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">id</tt><span class="msc">&gt;</span><span class="pcdata">0947b3e4-ed36-48da-9591-102a992d8bc4</span><span class="mso">&lt;/</span><tt class="tag-localname">id</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.validate-with-relax-ng"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:validate-with-relax-ng</tt></span></h2><p><span class="refname"><tt class="step">p:validate-with-relax-ng</tt></span> — Validates a document using a RELAX NG grammar.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:validate-with-relax-ng</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">schema</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">dtd-attribute-values</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>      </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">dtd-id-idref-warnings</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>     </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">assert-valid</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>               </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:validate-with-relax-ng</tt> step applies
<span class="formatting-error">???</span>
validation to its input document. If <tt class="option">assert-valid</tt> is true,
the step fails if the document is invalid, otherwise a copy of the input
appears on the output.</p>

<p>While there's no technical reason that the output couldn't be decorated
with type assignments, in practice there aren't any RELAX NG validators that do
that at this time.</p>

<p>If the <tt class="option">dtd-attribute-values</tt> option is
<tt class="literal">true</tt>, then the attribute value defaulting conventions of
<span class="formatting-error">???</span> are also applied. In practice,
there aren't any RELAX NG validators that do that at this time either.</p>

<p>If the <tt class="option">dtd-id-idref-warnings</tt> option is
<tt class="literal">true</tt>, then the validator should
treat a schema that is incompatible with the ID/IDREF/IDREFs feature
of <span class="formatting-error">???</span> as if the document
was invalid. In other words, this option enables ID/IDREF checking.
</p>

<p>If the root element of the schema is <tt class="tag-element">c:data</tt> or
has a <tt class="tag-attribute">c:content-type</tt> attribute that specifies
a text content type or a media type that the implementation recognizes,
then the step should treat the
text node descendants of the element as a
<span class="formatting-error">???</span> document for validation.
Support for this feature is <em class="glossterm">implementation defined</em>.
</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0053"/><code>err:C0053</code></td><td style="">Occurs
if the <tt class="option">assert-valid</tt> option is <tt class="literal">true</tt>
and the input document is not valid.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>The simplest use of <tt class="step">p:validate-with-relax-ng</tt> simply validates
a document.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">main</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-localname">grammar</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://relaxng.org/ns/structure/1.0</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-localname">start</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-localname">ref</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">doc</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-localname">start</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-localname">define</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">doc</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-localname">element</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">doc</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;</span><tt class="tag-localname">optional</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                </span><span class="mso">&lt;</span><tt class="tag-localname">ref</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">title</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;/</span><tt class="tag-localname">optional</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;</span><tt class="tag-localname">zeroOrMore</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                </span><span class="mso">&lt;</span><tt class="tag-localname">ref</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">p</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;/</span><tt class="tag-localname">zeroOrMore</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;/</span><tt class="tag-localname">element</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-localname">define</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-localname">define</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">title</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-localname">element</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">title</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;</span><tt class="tag-localname">text</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;/</span><tt class="tag-localname">element</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 25</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-localname">define</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-localname">define</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">p</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-localname">element</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">p</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">              </span><span class="mso">&lt;</span><tt class="tag-localname">text</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;/</span><tt class="tag-localname">element</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 30</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-localname">define</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-localname">grammar</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 35</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-relax-ng</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">main</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 40</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schema</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-relax-ng</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/validate-with-relax-ng-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>In practice, the grammar is rarely “inlined” in the pipeline. In this,
and future examples, we'll simply load it from the filesystem.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-relax-ng</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schema</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">document</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">../docs/grammar.rng</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-relax-ng</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/validate-with-relax-ng-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>If you load a compact syntax schema with <tt class="tag-element">p:data</tt> (instead
of <tt class="tag-element">p:document</tt>) then XML Calabash will validate with that.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-relax-ng</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schema</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">data</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">../docs/grammar.rnc</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-relax-ng</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/validate-with-relax-ng-3.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Validity errors will cause the step to fail if
    <tt class="option">assert-valid</tt> is true.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">try</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">group</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-relax-ng</tt><span class="pcdata"> </span><tt class="tag-attribute">assert-valid</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">true</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schema</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">data</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">../docs/grammar.rnc</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-relax-ng</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">group</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">catch</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="mso">&lt;</span><tt class="tag-localname">failed</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">catch</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">try</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/validate-with-relax-ng-4.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">not-valid</tt><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">failed</tt><span class="msc">/&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.validate-with-schematron"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:validate-with-schematron</tt></span></h2><p><span class="refname"><tt class="step">p:validate-with-schematron</tt></span> — Validates a document using a Schematron schema.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:validate-with-schematron</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">parameters</code><code>"</code> <code class="attr kind-attr">kind</code><code>="</code><code class="value kind-value">parameter</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">schema</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">report</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">phase</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'#ALL'</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">assert-valid</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>               </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:validate-with-schematron</tt> step applies
<span class="formatting-error">???</span>
processing to its input document. If <tt class="option">assert-valid</tt> is
true, the step fails if any Schematron assertions fail, otherwise a
copy of the input appears on the output.</p>

<p>The value of the <tt class="option">phase</tt> option identifies the
Schematron validation phase with which validation begins.
The <tt class="port">parameters</tt> port provides name/value pairs which
correspond to Schematron external variables.</p>

<p>The <tt class="port">result</tt> output from this step is a copy of the
input. Schematron assertions and reports, if any, appear on the
<tt class="port">report</tt> port. The output should be in
<em class="citetitle">Schematron Validation Report Language</em>
(SVRL).</p>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0054"/><code>err:C0054</code></td><td style="">Occurs
if the <tt class="option">assert-valid</tt> option is <tt class="literal">true</tt>
and any Schematron assertions fail.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>The Schematron language is (XPath) rule based, rather than grammar
based (like XML Schema and RELAX NG). As a consequence, it can be used to test
assertions of arbitrary complexity.</p><p>One such example is the DocBook rule about bibliography references.
The DocBook <tt class="tag-element">biblioref</tt> element <em>must</em> point to a
bibliography entry. Grammar-based parsers can check that the IDREF attribute on
a <tt class="tag-element">biblioref</tt> element points to an ID that exists, but they don't check
to see what kind of element has that ID.</p><p>Enter Schematron. Here's a simple rule that tests <tt class="tag-element">biblioref</tt>
elements:</p><div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;s:pattern name="'biblioref' type constraint"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>   &lt;s:rule context="db:biblioref[@linkend]"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>      &lt;s:assert test="local-name(//*[@xml:id=current()/@linkend]) = 'bibliomixed'
<span class="linenumber">   </span><span class="linenumber-separator"> </span>          and namespace-uri(//*[@xml:id=current()/@linkend])
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>              = 'http://docbook.org/ns/docbook'"&gt;@linkend on biblioref must point
<span class="linenumber">   </span><span class="linenumber-separator"> </span>to a bibliography entry.&lt;/s:assert&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>   &lt;/s:rule&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/s:pattern&gt;
</pre></div><p>This rule asserts that when a <tt class="tag-element">bibloref</tt> element has a
<tt class="tag-attribute">linkend</tt> attribute, that attribute's value must be the
<tt class="tag-attribute">xml:id</tt> value of a <tt class="tag-element">bibliomixed</tt> element in the
DocBook namespace. (A slight simplification of
the real rule which checks for a few other elements as well.)</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">main</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-schematron</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schema</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">document</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">../docs/rules.sch</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-schematron</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/validate-with-schematron-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://docbook.org/ns/docbook</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Chapter title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">What about this book: </span><span class="mso">&lt;</span><tt class="tag-localname">biblioref</tt><span class="pcdata"> </span><tt class="tag-attribute">linkend</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">someid</span><span class="attq">"</span><span class="msc">/&gt;</span><span class="pcdata">.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">bibliography</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">bibliomixed</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">someid</span><span class="attq">"</span><span class="msc">&gt;</span><span class="mso">&lt;</span><tt class="tag-localname">abbrev</tt><span class="msc">&gt;</span><span class="pcdata">BOOK</span><span class="mso">&lt;/</span><tt class="tag-localname">abbrev</tt><span class="msc">&gt;</span><span class="pcdata"> Title, Author,</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">etc.</span><span class="mso">&lt;/</span><tt class="tag-localname">bibliomixed</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">bibliography</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://docbook.org/ns/docbook</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Chapter title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">What about this book: </span><span class="mso">&lt;</span><tt class="tag-localname">biblioref</tt><span class="pcdata"> </span><tt class="tag-attribute">linkend</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">someid</span><span class="attq">"</span><span class="msc">/&gt;</span><span class="pcdata">.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">bibliography</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">bibliomixed</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">someid</span><span class="attq">"</span><span class="msc">&gt;</span><span class="mso">&lt;</span><tt class="tag-localname">abbrev</tt><span class="msc">&gt;</span><span class="pcdata">BOOK</span><span class="mso">&lt;/</span><tt class="tag-localname">abbrev</tt><span class="msc">&gt;</span><span class="pcdata"> Title, Author,</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">etc.</span><span class="mso">&lt;/</span><tt class="tag-localname">bibliomixed</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">bibliography</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>When an assertion fails, the error message is sent to the
<tt class="port">report</tt> port.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">main</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-schematron</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schematron</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">                              </span><tt class="tag-attribute">assert-valid</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">false</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schema</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">document</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">../docs/rules.sch</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-schematron</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">sink</tt><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schematron</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">report</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/validate-with-schematron-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">chapter</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://docbook.org/ns/docbook</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Chapter title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span><span class="pcdata">What about this book: </span><span class="mso">&lt;</span><tt class="tag-localname">biblioref</tt><span class="pcdata"> </span><tt class="tag-attribute">linkend</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">bibl</span><span class="attq">"</span><span class="msc">/&gt;</span><span class="pcdata">.</span><span class="mso">&lt;/</span><tt class="tag-localname">para</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">bibliography</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">bibl</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">bibliomixed</tt><span class="pcdata"> </span><tt class="tag-attribute">xml:id</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">someid</span><span class="attq">"</span><span class="msc">&gt;</span><span class="mso">&lt;</span><tt class="tag-localname">abbrev</tt><span class="msc">&gt;</span><span class="pcdata">BOOK</span><span class="mso">&lt;/</span><tt class="tag-localname">abbrev</tt><span class="msc">&gt;</span><span class="pcdata"> Title, Author,</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">etc.</span><span class="mso">&lt;/</span><tt class="tag-localname">bibliomixed</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">bibliography</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">chapter</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">svrl</tt><span class="colon">:</span><tt class="tag-localname">schematron-output</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:svrl</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://purl.oclc.org/dsdl/svrl</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                        </span><span class="nsdecl"><tt class="tag-attribute">xmlns:iso</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://purl.oclc.org/dsdl/schematron</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                        </span><span class="nsdecl"><tt class="tag-attribute">xmlns:xs</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/2001/XMLSchema</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                        </span><span class="nsdecl"><tt class="tag-attribute">xmlns:schold</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.ascc.net/xml/schematron</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">                        </span><span class="nsdecl"><tt class="tag-attribute">xmlns:db</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://docbook.org/ns/docbook</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                        </span><tt class="tag-attribute">title</tt><span class="atteq">=</span><span class="attq">"</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                        </span><tt class="tag-attribute">schemaVersion</tt><span class="atteq">=</span><span class="attq">"</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">!--</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">svrl</tt><span class="colon">:</span><tt class="tag-localname">ns-prefix-in-attribute-values</tt><span class="pcdata"> </span><tt class="tag-attribute">uri</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://docbook.org/ns/docbook</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">                                      </span><tt class="tag-attribute">prefix</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">db</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">svrl</tt><span class="colon">:</span><tt class="tag-localname">active-pattern</tt><span class="pcdata"> </span><tt class="tag-attribute">document</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">file:/projects/xproc/src/core/build/../xpl/validate-with-schematron-2.xpl</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">svrl</tt><span class="colon">:</span><tt class="tag-localname">fired-rule</tt><span class="pcdata"> </span><tt class="tag-attribute">context</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">db:biblioref[@linkend]</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">svrl</tt><span class="colon">:</span><tt class="tag-localname">failed-assert</tt><span class="pcdata"> </span><tt class="tag-attribute">test</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">local-name(//*[@xml:id=current()/@linkend]) = 'bibliomixed' and namespace-uri(//*[@xml:id=current()/@linkend]) = 'http://docbook.org/ns/docbook'</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                      </span><tt class="tag-attribute">location="/*[local-name()='chapter']/*[local-name()='para']/*[local-name()</tt><span class="atteq">=</span><span class="attq">'</span><span class="attvalue">biblioref</span><span class="attq">'</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">svrl</tt><span class="colon">:</span><tt class="tag-localname">text</tt><span class="msc">&gt;</span><span class="pcdata">@linkend on biblioref must point to a bibliography entry.</span><span class="mso">&lt;/</span><tt class="tag-prefix">svrl</tt><span class="colon">:</span><tt class="tag-localname">text</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">svrl</tt><span class="colon">:</span><tt class="tag-localname">failed-assert</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">svrl</tt><span class="colon">:</span><tt class="tag-localname">schematron-output</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>If you want to read the <tt class="port">report</tt> output, you must specify
that <tt class="option">assert-valid</tt> is “<tt class="literal">false</tt>”, otherwise
the step fails and there's no way to read the <tt class="port">report</tt> output.
    </p>

</div></div><div class="refentry" id="p.validate-with-xml-schema"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:validate-with-xml-schema</tt></span></h2><p><span class="refname"><tt class="step">p:validate-with-xml-schema</tt></span> — Validates a document using W3C XML Schema.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:validate-with-xml-schema</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">schema</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">use-location-hints</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>        </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">try-namespaces</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>            </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">assert-valid</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'true'</code><code>"</code><code>/&gt;</code><code>               </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">mode</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'strict'</code><code>"</code><code>/&gt;</code><code>                     </code><code class="comment">&lt;!-- </code><span class="opt-type">"strict" | "lax"</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:validate-with-xml-schema</tt> step applies
<span class="formatting-error">???</span>
validity assessment to its input document. If
<tt class="option">assert-valid</tt> is true, the step fails if the document
is invalid, otherwise a copy of the input appears on the output,
possibly representing an augmented PSVI.</p>

<p>Validation is performed against the set of schemas represented
by the documents on the <tt class="port">schema</tt> port. These schemas must
be used in preference to any schema locations provided by schema
location hints encountered during schema validation, that is, schema
locations supplied for <tt class="code">xs:import</tt> or
<tt class="code">xsi:schema-location</tt>, or determined by
schema-processor-defined namespace-based strategies, for the
namespaces covered by the documents available on the schemas port.</p>

<p>If <tt class="code">xs:include</tt> elements occur within the supplied
schema documents, they are treated like any other
external documents (see <span class="formatting-error">???</span>). It is
<em class="glossterm">implementation-defined</em> if the documents
supplied on the <tt class="port">schemas</tt> port are considered when
resolving <tt class="code">xs:include</tt> elements in the schema documents
provided.
</p>

<p>The <tt class="option">use-location-hints</tt> and
<tt class="option">try-namespaces</tt> options allow the pipeline author to
control how the schema processor should attempt to locate schema
documents necessary but not provided on the <tt class="port">schema</tt> port.
Any schema documents provided on the <tt class="port">schema</tt> port are used
in preference to schema documents located by other means.</p>

<p>If the <tt class="option">use-location-hints</tt> option is
“<tt class="literal">true</tt>”, the processor should make use of schema
location hints to locate schema documents. If the option is
“<tt class="literal">false</tt>”, the processor should ignore any such
hints.</p>

<p>If the <tt class="option">try-namespaces</tt> option is
“<tt class="literal">true</tt>”, the processor should
attempt to dereference the namespace URI to locate schema documents.
If the
option is “<tt class="literal">false</tt>”, the processor
should not dereference namespace URIs.</p>

<p>The <tt class="option">mode</tt> option allow the pipeline author to
control how schema validation begins. It must be either
“<tt class="literal">strict</tt>” or “<tt class="literal">lax</tt>”.
The “<tt class="literal">strict</tt>”
mode means that the document element must be declared and
schema-valid, otherwise it will be treated as invalid. The
“<tt class="literal">lax</tt>” mode means that the
absence of a declaration for the document element does not itself
count as an unsuccessful outcome of validation.</p>

<p>If the <tt class="option">assert-valid</tt>
option is <tt class="literal">false</tt>, it is not an error for the document
to be invalid. In this case, if the implementation does not
support the PSVI, <tt class="tag-element">p:validate-with-xml-schema</tt> is essentially
just an “identity” step, but if the implementation <em>does</em>
support the PSVI, then the resulting document will have additional type
information (at least for the subtrees that are valid).</p>

<p>The <tt class="port">result</tt> of the assessment is a document with the
Post-Schema-Validation-Infoset (PSVI) (<span class="formatting-error">???</span>) annotations, if the pipeline implementation
supports such annotations. If not, the input document is reproduced
with any defaulting of attributes and elements performed as specified
by the XML Schema recommendation.</p>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0053.1"/><code>err:C0053</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the <tt class="option">assert-valid</tt> option is <tt class="literal">true</tt>
and the input document is not valid.
</td></tr><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0055"/><code>err:C0055</code></td><td style="">Occurs if a <tt class="option">mode</tt> is specified and
the implementation does not support the specified mode.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>The simplest use of <tt class="step">p:validate-with-xml-schema</tt> simply validates
a document.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">main</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-xml-schema</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schema</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">document</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">../docs/document.xsd</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-xml-schema</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/validate-with-xml-schema-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>FIXME: more examples, showing all the various options and what
they do.</p><p>XML Schema output is a PSVI which may include both defaulted attributes
and type information. Here we see a default attribute added to the <tt class="tag-element">div</tt>
element.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">main</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-xml-schema</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schema</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">document</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">../docs/document.xsd</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-xml-schema</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/validate-with-xml-schema-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="pcdata"> </span><tt class="tag-attribute">class</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">normal</span><span class="attq">"</span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Type information doesn't show up in the serialized output, but it
can be used in the pipeline, as we see here:</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">main</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">//element(*,xs:anyURI)</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap-sequence</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">wrapper1</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">uris-before-validation</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-xml-schema</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">main</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">schema</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">document</tt><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">../docs/document.xsd</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">validate-with-xml-schema</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">//element(*,xs:anyURI)</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">identity</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap-sequence</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">wrapper2</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber"> 25</span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">uris-after-validation</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap-sequence</tt><span class="pcdata"> </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">uris</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">wrapper1</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 30</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipe</tt><span class="pcdata"> </span><tt class="tag-attribute">step</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">wrapper2</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">result</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap-sequence</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/validate-with-xml-schema-3.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Title</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some paragraph</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">with a uri: </span><span class="mso">&lt;</span><tt class="tag-localname">uri</tt><span class="msc">&gt;</span><span class="pcdata">http://example.com/</span><span class="mso">&lt;/</span><tt class="tag-localname">uri</tt><span class="msc">&gt;</span><span class="pcdata">.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">doc</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">uris</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">uris-before-validation</tt><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">uris-after-validation</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">uri</tt><span class="msc">&gt;</span><span class="pcdata">http://example.com/</span><span class="mso">&lt;/</span><tt class="tag-localname">uri</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">uris-after-validation</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">uris</tt><span class="msc">&gt;</span></span></div></div></td></tr></table>

</div></div><div class="refentry" id="p.wrap-sequence"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:wrap-sequence</tt></span></h2><p><span class="refname"><tt class="step">p:wrap-sequence</tt></span> — Places an element wrapper around a sequence of documents.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:wrap-sequence</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">wrapper</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                    </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">wrapper-prefix</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">NCName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">wrapper-namespace</code><code>"</code><code>/&gt;</code><code>                          </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">group-adjacent</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">XPathExpression</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:wrap-sequence</tt> step is something like the
<tt class="step">p:wrap</tt> step except that instead of operating on nodes within
a document, it operates on a sequence of documents.</p>

<p>In the simple case, the <tt class="step">p:wrap-sequence</tt> step turns
a sequence of documents into a single document; it creates a new
document element and inserts the content of each document in the
sequence into the new element.
In the not so simple case, the <tt class="option">group-adjacent</tt>
expression can be used to group the documents in a sequence.</p>

<p>The name of
the wrapper is computed from the <tt class="option">wrapper</tt>,
<tt class="option">wrapper-prefix</tt>, and <tt class="option">wrapper-namespace</tt>
options. If the <tt class="option">wrapper</tt> value contains a colon, then
its value is interpreted as a QName and there must be an in-scope namespace
declaration for that prefix in the pipeline document. It is an error in this
case to specify either a <tt class="option">wrapper-prefix</tt> or
<tt class="option">wrapper-namespace</tt>.</p>

<p>The <tt class="option">group-adjacent</tt> option can be used to group
adjacent documents. For each input document, the <tt class="option">group-adjacent</tt>
expression is evaluated with the input document as the context. Whenever
two or more sequentially adjacent documents yield the same value for
the <tt class="option">group-adjacent</tt> option, they are wrapped together.
</p>

<p>The context position (<tt class="code">position()</tt>) is the position
of that document within the sequence and the context size
(<tt class="code">last()</tt>) is the total number of documents in the
sequence.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.D0034.5"/><code>err:D0034</code></td><td style="">Occurs
if either <tt class="option">wrapper-namespace</tt> or
<tt class="option">wrapper-prefix</tt> are specified when the
<tt class="option">wrapper</tt> name contains a colon.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>FIXME: TBD. (The harness that runs examples for the book doesn't
have any way of taking in a sequence of documents.)</p>

</div></div><div class="refentry" id="p.wrap"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:wrap</tt></span></h2><p><span class="refname"><tt class="step">p:wrap</tt></span> — Adds a wrapper around matching nodes.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:wrap</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">wrapper</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                    </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">wrapper-prefix</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">NCName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">wrapper-namespace</code><code>"</code><code>/&gt;</code><code>                          </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">group-adjacent</code><code>"</code><code>/&gt;</code><code>                             </code><code class="comment">&lt;!-- </code><span class="opt-type">XPathExpression</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>In the simple case, the <tt class="step">p:wrap</tt> step adds a wrapper
element around matching nodes in the document; it creates a new
element and inserts the content of each match into that element.
In the not so simple case, the <tt class="option">group-adjacent</tt>
expression can be used to group adjacent nodes together.</p>

<p>The name of
the wrapper is computed from the <tt class="option">wrapper</tt>,
<tt class="option">wrapper-prefix</tt>, and <tt class="option">wrapper-namespace</tt>
options. If the <tt class="option">wrapper</tt> value contains a colon, then
its value is interpreted as a QName and there must be an in-scope namespace
declaration for that prefix in the pipeline document. It is an error in this
case to specify either a <tt class="option">wrapper-prefix</tt> or
<tt class="option">wrapper-namespace</tt>.</p>

<p>The <tt class="option">group-adjacent</tt> option can be used to group
adjacent nodes. For each matching node, the <tt class="option">group-adjacent</tt>
expression is evaluated with that node as the context. Whenever
two or more adjacent nodes yield the same value for
the <tt class="option">group-adjacent</tt> option, they are wrapped together.
Two matching nodes are considered adjacent if they
are siblings and either there are no nodes between them or all
intervening, non-matching nodes are whitespace text, comment, or processing
instruction nodes.</p>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.D0034.6"/><code>err:D0034</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if either <tt class="option">wrapper-namespace</tt> or
<tt class="option">wrapper-prefix</tt> are specified when the
<tt class="option">wrapper</tt> name contains a colon.
</td></tr><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0023.8"/><code>err:C0023</code></td><td style="">Occurs
if the <tt class="option">match</tt> pattern matches
anything other than document, element, text, processing instruction, and comment
nodes.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>Here we use <tt class="step">p:wrap</tt> to wrap each <tt class="tag-element">p</tt> in 
a <tt class="tag-element">div</tt>.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">h:p</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">div</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">wrapper-namespace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/wrap-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Yet even more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Yet even more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Using <tt class="option">group-adjacent</tt> we can group elements together.
Notice how it's the value of the <tt class="option">group-adjacent</tt> option that
matters. The expression <tt class="code">local-name(.)</tt> will be the same for
both <tt class="tag-element">p</tt> elements, so they match.
    </p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">h:p</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">div</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">wrapper-namespace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">group-adjacent</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">local-name(.)</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/wrap-2.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Yet even more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Yet even more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>The first and second paragraphs are not adjacent because a
    <tt class="tag-element">pre</tt> intervenes.</p><p>In this example, we use a more complex expression to group all
paragraphs except the first.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">h:p</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">div</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">wrapper-namespace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">group-adjacent</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">count(preceding-sibling::h:p) <tt class="tag-genentity">&amp;gt;</tt> 1</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/wrap-3.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Yet even more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">A third paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Yet even more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">A third paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>This is close to what we want, we're successfully grouping all the
paragraphs except the first, but if the goal was to <em>only</em>
wrap the non-first paragraphs, we're getting extra wrappers.</p><p>That's because each “first paragraph” forms its own group where the value
of the <tt class="option">group-adjacent</tt> option is “<tt class="literal">false</tt>”.</p><p>We can jump this last hurdle by changing the
<tt class="option">match</tt> option so that it doesn't even consider
first paragraphs.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">h:p[count(preceding-sibling::h:p) <tt class="tag-genentity">&amp;gt;</tt> 1]</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">div</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">wrapper-namespace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">group-adjacent</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">count(preceding-sibling::h:p) <tt class="tag-genentity">&amp;gt;</tt> 1</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/wrap-4.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Yet even more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">A third paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Yet even more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">A third paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>You might think that the more complex <tt class="option">match</tt>
    expression was sufficient, but it isn't. See what happens when we
    remove the <tt class="option">group-adjacent</tt>?</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:h</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">wrap</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">h:p[count(preceding-sibling::h:p) <tt class="tag-genentity">&amp;gt;</tt> 1]</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">wrapper</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">div</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">          </span><tt class="tag-attribute">wrapper-namespace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/wrap-5.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Yet even more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">A third paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">html</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/1999/xhtml</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span><span class="pcdata">Some Document</span><span class="mso">&lt;/</span><tt class="tag-localname">title</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">head</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span><span class="pcdata">Some example pre text.</span><span class="mso">&lt;/</span><tt class="tag-localname">pre</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Some more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">Yet even more text.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="diff"><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span><span class="pcdata">A third paragraph.</span><span class="mso">&lt;/</span><tt class="tag-localname">p</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span class="add"><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-localname">div</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-localname">body</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">html</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>Although we still avoid first paragraphs, we no longer get the
    grouping.</p>

</div></div><div class="refentry" id="p.www-form-urldecode"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:www-form-urldecode</tt></span></h2><p><span class="refname"><tt class="step">p:www-form-urldecode</tt></span> — Decodes URL encoded form data.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:www-form-urldecode</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">value</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The most common way for browsers to send parameters to a web service
is with an encoding called “<tt class="literal">x-www-form-urlencoded</tt>”.
You've all seen it:</p>

<div class="screen"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>http://example.org/service?a=b&amp;c=d&amp;e=&amp;f
</pre></div>

<p>The “<tt class="literal">a=b&amp;c=d&amp;e=&amp;f</tt>” part is the
three parameters (a=b, c=d, and e=f) sent in
<tt class="literal">x-www-form-urlencoded</tt> format.</p>

<p>The <tt class="step">p:www-form-urldecode</tt> step interprets a URL
encoded string and returns a <tt class="tag-element">c:param-set</tt> containing the
parameters.
This step is the effectively the opposite of
<tt class="step">p:www-form-urlencode</tt>.
</p>

<p>The order of the <tt class="tag-element">c:param</tt> elements in the result is the same
as the order of the encoded parameters, reading from left to right.</p>

<p>If any parameter name occurs more than once in the encoded string,
the resulting parameter set will contain a <tt class="tag-element">c:param</tt> for
each instance. However, only one of these will actually be used if the
parameter set is passed to another step on its <em class="glossterm">parameter
input port</em>.</p>

<p>One limitation of this step is that it cannot represent a set of
parameters if the names are not ordinary XML “local names”. Attempting
to decode the following string, for example, will cause the step to
fail:</p>

<div class="screen"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>x::y=value
</pre></div>

<p>The name “<tt class="literal">x::y</tt>” cannot be represented in a
<tt class="tag-element">c:param-set</tt>.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0037"/><code>err:C0037</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the <tt class="option">value</tt> provided
is not a properly
<tt class="literal">x-www-form-urlencoded</tt> value.
</td></tr><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0061"/><code>err:C0061</code></td><td style="">Occurs
if the name of any encoded parameter
name is not a valid XML name (without a colon).
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>This example is predicated on the notion that the pipeline is
being used to implement some web service end point. The web server packages
up the request in XML and passes it on to our pipeline.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">www-form-urldecode</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:ws</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://example.com/webservice</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">with-option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">value</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                   </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/ws:request/ws:params</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">www-form-urldecode</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/www-form-urldecode-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Input</th><th>→</th><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://example.com/webservice</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">uri</tt><span class="msc">&gt;</span><span class="pcdata">http://example.com/service</span><span class="mso">&lt;/</span><tt class="tag-localname">uri</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-localname">params</tt><span class="msc">&gt;</span><span class="pcdata">a=b<tt class="tag-genentity">&amp;amp;</tt>c=d<tt class="tag-genentity">&amp;amp;</tt>test=this%20or%20that</span><span class="mso">&lt;/</span><tt class="tag-localname">params</tt><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-localname">request</tt><span class="msc">&gt;</span></span></div></div></td><td valign="middle"><span class="arrow"> </span></td><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">param-set</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span><span class="msc">&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">param</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">a</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">b</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">param</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">c</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">d</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">param</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">test</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">value</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">this or that</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div><div class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">param-set</tt><span class="msc">&gt;</span></span></div></div></td></tr></table><p>A web service that simply returned its parameters decoded into
a <tt class="tag-element">c:param-set</tt> would be pretty pointless. In a real pipeline, they'd
probably be passed to <tt class="step">p:xslt</tt> or some other step.</p>

</div></div><div class="refentry" id="p.www-form-urlencode"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:www-form-urlencode</tt></span></h2><p><span class="refname"><tt class="step">p:www-form-urlencode</tt></span> — Encodes parameters into URL encoded form data.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:www-form-urlencode</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">parameters</code><code>"</code> <code class="attr kind-attr">kind</code><code>="</code><code class="value kind-value">parameter</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">match</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                      </code><code class="comment">&lt;!-- </code><span class="opt-type">XSLTMatchPattern</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="step">p:www-form-urlencode</tt> step encodes a set of parameter
values as an “<tt class="literal">x-www-form-urlencoded</tt>” string and
injects it into the input document at the location(s) specified by the
<tt class="option">match</tt> option.</p>

<p>This step is the effectively the opposite of
<tt class="step">p:www-form-urldecode</tt>.
The set of parameters is encoded as a single
<tt class="literal">x-www-form-urlencoded</tt> string of name/value pairs
When parameters are encoded into name/value pairs,
<em>only</em> the local name of each parameter is used.
The namespace name is ignored and no prefix or colon appears in the name.
</p>

<p>The parameters are encoded in document order. That is, the first
parameter appears first in the resulting string, the second parameter
second, etc. reading from left to right.</p>

<p>The matched nodes are specified with the match pattern in the
<tt class="option">match</tt> option. For each matching node, the encoded
string is used in the output.</p>

<p>If the expression given in the <tt class="option">match</tt> option
matches an <em>attribute</em>, the encoded
string is used as the new value of the attribute in the output.
If the expression matches any other kind of node, the entire
node (and <em>not</em> just its contents) is replaced by
the encoded string.</p>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>In this example, we package up some options as parameters for
a web service call.</p><div class="programlisting"><pre>
<span class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:p</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">            </span><tt class="tag-attribute">version</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">1.0</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">  5</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">a</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'default a'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">c</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'default c'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">option</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">test</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">'default test'</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 10</span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">www-form-urlencode</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/c:request/@href</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="pcdata"> </span><tt class="tag-attribute">port</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">source</span><span class="attq">"</span><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">        </span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">get</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">@@</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 15</span><span class="linenumber-separator"> </span><span><span class="pcdata">      </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">inline</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">input</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">with-param</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">a</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">$a</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">with-param</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">c</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">$c</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">    </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">with-param</tt><span class="pcdata"> </span><tt class="tag-attribute">name</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">test</span><span class="attq">"</span><span class="pcdata"> </span><tt class="tag-attribute">select</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">$test</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber"> 20</span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">www-form-urlencode</tt><span class="msc">&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span/></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">  </span><span class="mso">&lt;</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">string-replace</tt><span class="pcdata"> </span><tt class="tag-attribute">match</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">/c:request/@href</span><span class="attq">"</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">                    </span><tt class="tag-attribute">replace</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">concat('http://example.com/service?', .)</span><span class="attq">"</span><span class="msc">/&gt;</span></span></span>
<span class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="mso">&lt;/</span><tt class="tag-prefix">p</tt><span class="colon">:</span><tt class="tag-localname">pipeline</tt><span class="msc">&gt;</span></span></span>
</pre></div><div class="exlink"><a href="build/xpl/www-form-urlencode-1.xpl">Download pipeline</a></div><table class="pipelineexample" cellspacing="0" cellpadding="0"><tr><th>Output</th></tr><tr><td valign="top"><div class="programlisting"><div class="line"><span class="linenumber">  1</span><span class="linenumber-separator"> </span><span><span class="mso">&lt;</span><tt class="tag-prefix">c</tt><span class="colon">:</span><tt class="tag-localname">request</tt><span class="pcdata"> </span><span class="nsdecl"><tt class="tag-attribute">xmlns:c</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://www.w3.org/ns/xproc-step</span><span class="attq">"</span></span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">           </span><tt class="tag-attribute">method</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">get</span><span class="attq">"</span></span></div><div class="line"><span class="linenumber">   </span><span class="linenumber-separator"> </span><span><span class="pcdata">           </span><tt class="tag-attribute">href</tt><span class="atteq">=</span><span class="attq">"</span><span class="attvalue">http://example.com/service?a=default%20a<tt class="tag-genentity">&amp;amp;</tt>c=default%20c<tt class="tag-genentity">&amp;amp;</tt>test=default%20test</span><span class="attq">"</span><span class="msc">/&gt;</span></span></div></div></td></tr></table><p>In a real pipeline, we'd almost certainly pass this <tt class="tag-element">c:request</tt>
element on to a <tt class="step">p:http-request</tt> step, not return it.</p>

</div></div><div class="refentry" id="p.xinclude"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:xinclude</tt></span></h2><p><span class="refname"><tt class="step">p:xinclude</tt></span> — Performs XInclude processing.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:xinclude</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">fixup-xml-base</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>            </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">fixup-xml-lang</code><code>"</code> <code class="attr select-attr">select</code><code>="</code><code class="value select-value">'false'</code><code>"</code><code>/&gt;</code><code>            </code><code class="comment">&lt;!-- </code><span class="opt-type">boolean</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:xinclude</tt> step applies <span class="formatting-error">???</span> processing to its input
document.</p>

<p>If <tt class="option">fixup-xml-base</tt> is “<tt class="literal">true</tt>”,
base URI fixup will be performed, and if
<tt class="option">fixup-xml-lang</tt> is “<tt class="literal">true</tt>”,
language fixup will be performed, both as per
<span class="formatting-error">???</span>.</p>

<p>The included documents are located with the base URI of the
input document and are not provided as input to the step. Whether the
output of preceding steps can be incorporated via XInclude is
<em class="glossterm">implementation-defined</em>.</p>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0029"/><code>err:C0029</code></td><td style="">Occurs
if an XInclude error occurs during processing.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>FIXME: tbd.</p>

</div></div><div class="refentry" id="p.xquery"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:xquery</tt></span></h2><p><span class="refname"><tt class="step">p:xquery</tt></span> — Performs XQuery processing.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:xquery</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">query</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">parameters</code><code>"</code> <code class="attr kind-attr">kind</code><code>="</code><code class="value kind-value">parameter</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:xquery</tt> step applies an
<span class="formatting-error">???</span> query to the sequence of documents
provided as input.</p>

<p>The first document provided on the <tt class="port">source</tt>
port is used as the
initial context item. The whole sequence is also the default
collection. If no documents are provided on the <tt class="port">source</tt> port,
the initial context item is undefined and the default collection
is empty.</p>

<p>The <tt class="port">query</tt> port must receive a single document:</p>

<div class="itemizedlist"><ul><li><p>If the document root element is <tt class="tag-element" id="cv.query">c:query</tt>, the text
descendants of this element are considered the query.</p></li><li><p>If the document root element is in the XQueryX namespace, the
document is treated as an XQueryX-encoded query. Support for
XQueryX is <em class="glossterm">implementation-defined</em>.
</p></li><li><p>If the document root element is <tt class="tag-element">c:data</tt> and either
does not have a <tt class="tag-attribute">content-type</tt> attribute or
has a <tt class="tag-attribute">content-type</tt> attribute that
specifies a text content type or a media type that the implementation
recognizes, then the text descendants of this element are considered
the query.</p></li><li><p>If the document root element is not <tt class="tag-element">c:data</tt> but
has a <tt class="tag-attribute">c:content-type</tt> attribute that specifies
a text content type or a media type that the implementation recognizes,
then the text descendants of this element are considered
the query.</p></li><li><p>Otherwise, the interpretation of the query
is <em class="glossterm">implementation-defined</em>.
</p></li></ul></div>

<p>The result of the <tt class="tag-element">p:xquery</tt> step must be a sequence of
documents. <a name="err.inline.C0057"/>It is a <em class="glossterm">dynamic
error</em> (<a href="#err.C0057"><code class="errqname">err:XC0057</code></a>) if the sequence that results from evaluating the XQuery contains
items other than documents and elements. Any elements that appear
in the result sequence will be treated as documents with the element as their
document element.</p>

<p>For example:</p>
<div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;c:query&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>declare namespace atom="http://www.w3.org/2005/Atom";
<span class="linenumber">   </span><span class="linenumber-separator"> </span>/atom:feed/atom:entry
<span class="linenumber">  5</span><span class="linenumber-separator"> </span>&lt;/c:query&gt;
</pre></div>

<p>The output of this step may include PSVI annotations.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0057.1"/><code>err:C0057</code></td><td style="">Occurs
if the sequence that results from evaluating the XQuery contains
items other than documents and elements.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>FIXME: tbd.</p>

</div></div><div class="refentry" id="p.xsl-formatter"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:xsl-formatter</tt></span></h2><p><span class="refname"><tt class="step">p:xsl-formatter</tt></span> — Performs XSL FO processing.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:xsl-formatter</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">parameters</code><code>"</code> <code class="attr kind-attr">kind</code><code>="</code><code class="value kind-value">parameter</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">false</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-req"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">href</code><code>"</code> <code class="attr required-attr">required</code><code>="</code><code class="value required-value">true</code><code>"</code><code>/&gt;</code><code>                       </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">content-type</code><code>"</code><code>/&gt;</code><code>                               </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:xsl-formatter</tt> step receives an <span class="formatting-error">???</span> document and renders the content. The result of
rendering is stored to the URI provided via the <tt class="option">href</tt>
option. A reference to that result is produced on the output
port.</p>

<p>By default, the <tt class="step">p:xsl-formatter</tt> step produces PDF.
The content-type of the output can be controlled by the
<tt class="option">content-type</tt> option. This option specifies a media
type as defined by <span class="formatting-error">???</span>. The option may
include media type parameters as well (e.g.
"application/someformat; charset=UTF-8"). The use of media type
parameters on the <tt class="option">content-type</tt> option is
<em class="glossterm">implementation-defined</em>.</p>

<p>A formatter may take any number of optional rendering
parameters via the step's parameters; such parameters are defined by
the XSL implementation used and are
<em class="glossterm">implementation-defined</em>.</p>

<p>The output of this step is a document containing a single
<tt class="tag-element">c:result</tt> element whose content is the absolute URI of the
document stored by the step.</p>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>FIXME: tbd.</p>

</div></div><div class="refentry" id="p.xslt"><div class="refentry-separator"><hr/></div><div class="refnamediv"><h2><span class="refname"><tt class="step">p:xslt</tt></span></h2><p><span class="refname"><tt class="step">p:xslt</tt></span> — Performs XSLT processing.</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p class="element-syntax element-syntax-declare-step"><span class="decl"><code>&lt;p:declare-step</code> <code class="attr type-attr">type</code><code>="</code><code class="value type-value">p:xslt</code><code>"</code><code>&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">source</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">stylesheet</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:input</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">parameters</code><code>"</code> <code class="attr kind-attr">kind</code><code>="</code><code class="value kind-value">parameter</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">result</code><code>"</code> <code class="attr primary-attr">primary</code><code>="</code><code class="value primary-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="input"><code>&lt;p:output</code> <code class="attr port-attr">port</code><code>="</code><code class="value port-value">secondary</code><code>"</code> <code class="attr sequence-attr">sequence</code><code>="</code><code class="value sequence-value">true</code><code>"</code><code>/&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">initial-mode</code><code>"</code><code>/&gt;</code><code>                               </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">template-name</code><code>"</code><code>/&gt;</code><code>                              </code><code class="comment">&lt;!-- </code><span class="opt-type">QName</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">output-base-uri</code><code>"</code><code>/&gt;</code><code>                            </code><code class="comment">&lt;!-- </code><span class="opt-type">anyURI</span><code class="comment"> --&gt;</code></span><br/>     <span class="opt-opt"><code>&lt;p:option</code> <code class="attr name-attr">name</code><code>="</code><code class="value name-value">version</code><code>"</code><code>/&gt;</code><code>                                    </code><code class="comment">&lt;!-- </code><span class="opt-type">string</span><code class="comment"> --&gt;</code></span><br/><code>&lt;/p:declare-step&gt;</code></p></div><div class="refsection"><div class="refsection-titlepage"><h3>Description</h3></div>


<p>The <tt class="tag-element">p:xslt</tt> step applies an
<span class="formatting-error">???</span> or
<span class="formatting-error">???</span> stylesheet to a document.</p>

<p>If the step specifies a <tt class="option">version</tt>, then that
version of XSLT is used to process the transformation. If the step
does not specify a version, the implementation may use any version it
has available and may use any means to determine what version to use,
including, but not limited to, examining the version of the
stylesheet.</p>

<p>The XSLT stylesheet provided on the <tt class="port">stylesheet</tt> port
is applied to the document on the <tt class="port">source</tt> port. Any
parameters passed on the <tt class="port">parameters</tt> port are used to
define top-level stylesheet parameters. The primary result document of
the transformation appears on the <tt class="port">result</tt> port. All other
result documents appear on the <tt class="port">secondary</tt> port. If XSLT
1.0 is used, an empty sequence of documents always
appears on the <tt class="port">secondary</tt> port.</p>

<p>If a sequence of documents is provided on the
<tt class="port">source</tt> port, the first document is used as the
primary input document. The whole sequence is also the default
collection.
If no documents are provided on the <tt class="port">source</tt> port,
the primary input document is undefined and the default collection
is empty.
</p>

<p>A dynamic error occurs if the XSLT processor signals a fatal
error. This includes the case where the transformation terminates due
to a <tt class="tag-element">xsl:message</tt> instruction with a <tt class="tag-attribute">terminate</tt> attribute value of
“<tt class="literal">yes</tt>”. How XSLT message termination errors
are reported to the XProc processor is
<em class="glossterm">implementation-dependent</em>.</p>

<p>The invocation of the transformation is controlled by the
<tt class="option">initial-mode</tt> and <tt class="option">template-name</tt>
options that set the initial mode and/or named template in the XSLT
transformation where processing begins.
</p>

<p>The <tt class="option">output-base-uri</tt> option sets the context's
output base URI per the XSLT 2.0 specification, otherwise the base URI
of the <tt class="port">result</tt> document is the base URI of the first
document in the <tt class="code">source</tt> port's sequence. If the value of
the <tt class="option">output-base-uri</tt> option is not absolute, it will
be resolved using the base URI of its <tt class="tag-element">p:option</tt>
element. An XSLT 1.0 step should use the value of the
<tt class="option">output-base-uri</tt> as the base URI of its output, if the
option is specified.</p>

<p>If XSLT 2.0 is used, the outputs of this step may include PSVI
annotations.</p>

</div><div class="refsection"><div class="refsection-titlepage"><h3>Errors</h3></div>

<div class="informaltable-wrapper"><div class="informaltable"><table border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col width="14.29%"/><col width="85.71%"/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; ">Error</th><th style="">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0038"/><code>err:C0038</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if the specified version of XSLT
is not available.
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><a name="err.inline.C0039"/><code>err:C0039</code></td><td style="border-bottom: 0.5pt solid ; ">Occurs
if a sequence of documents (including
an empty sequence) is provided
to an XSLT 1.0 step.
</td></tr><tr><td style="border-right: 0.5pt solid ; "><a name="err.inline.C0056"/><code>err:C0056</code></td><td style="">Occurs
if the specified initial mode
or named template cannot be applied to the specified stylesheet.
</td></tr></tbody></table></div></div>
</div><div class="refsection"><div class="refsection-titlepage"><h3>Examples</h3></div>


<p>FIXME: tbd.</p>

</div></div></div></body></html>